<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>mrfioc2: MrfCommon</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">mrfioc2
   &#160;<span id="projectnumber">2.6.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">MrfCommon</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:mrf_frac_synth_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mrf_frac_synth_8c.html">mrfFracSynth.c</a></td></tr>
<tr class="memdesc:mrf_frac_synth_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Support routines for the Micrel SY87739L Fractional-N Synthesizer. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_post_divide_struct.html">PostDivideStruct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_correction_struct.html">CorrectionStruct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_correction_val_struct.html">CorrectionValStruct</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_frac_synth_components.html">FracSynthComponents</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:gad5aeca1a1a793c8ba18f85cbac89e768"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gad5aeca1a1a793c8ba18f85cbac89e768">DEBUG_PRINT</a>&#160;&#160;&#160;/* Debug printing always enabled for this module        */</td></tr>
<tr class="separator:gad5aeca1a1a793c8ba18f85cbac89e768"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6af78dc3b0b89a75db6f2d59ab9589ff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga6af78dc3b0b89a75db6f2d59ab9589ff">MAX_CORRECTION_RATIO</a>&#160;&#160;&#160;(17./14.)  /* Maximum value for correction term.                   */</td></tr>
<tr class="separator:ga6af78dc3b0b89a75db6f2d59ab9589ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga32482de274074ad01b9ad07b5a77e6e2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga32482de274074ad01b9ad07b5a77e6e2">MAX_VCO_FREQ</a>&#160;&#160;&#160;729.0    /* Maximum frequency for voltage-controlled oscillator  */</td></tr>
<tr class="separator:ga32482de274074ad01b9ad07b5a77e6e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4028643367a81118579bb9ff00dbb317"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga4028643367a81118579bb9ff00dbb317">MIN_VCO_FREQ</a>&#160;&#160;&#160;540.0    /* Minimum frequency for voltage-controlled oscillator  */</td></tr>
<tr class="separator:ga4028643367a81118579bb9ff00dbb317"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac0f6f780b72f7f28dde57624f5a1ef85"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gac0f6f780b72f7f28dde57624f5a1ef85">MIN_P_VALUE</a>&#160;&#160;&#160;17    /* Minimum val for integer part of fractional frequency */</td></tr>
<tr class="separator:gac0f6f780b72f7f28dde57624f5a1ef85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabef9b0318c864d32d39586183a047d94"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gabef9b0318c864d32d39586183a047d94">MAX_FRAC_DIVISOR</a>&#160;&#160;&#160;31    /* Maximum divisor for fractional frequency value       */</td></tr>
<tr class="separator:gabef9b0318c864d32d39586183a047d94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga67676a1360dc48867462b00234056f99"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga67676a1360dc48867462b00234056f99">NUM_POST_DIVIDES</a>&#160;&#160;&#160;31    /* Number of unique post-divider values                 */</td></tr>
<tr class="separator:ga67676a1360dc48867462b00234056f99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa60f29977f11d5548eb3f37f879e6fa2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gaa60f29977f11d5548eb3f37f879e6fa2">NUM_POST_DIVIDE_VALS</a>&#160;&#160;&#160;32    /* Number of post-divider codes                         */</td></tr>
<tr class="separator:gaa60f29977f11d5548eb3f37f879e6fa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga179cb66a9388422a1abb1514ab4dd468"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga179cb66a9388422a1abb1514ab4dd468">NUM_CORRECTIONS</a>&#160;&#160;&#160;23    /* Number of valid correction values (plus <a class="el" href="linkoptions_test_8c.html#a40086d8cf0e43ebc12c1b1a7fc81945d">one</a>)         */</td></tr>
<tr class="separator:ga179cb66a9388422a1abb1514ab4dd468"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga241008895c5b58e27fbb669623ab28ce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga241008895c5b58e27fbb669623ab28ce">NUM_CORRECTION_VALS</a>&#160;&#160;&#160;8    /* Number of correction value codes                     */</td></tr>
<tr class="separator:ga241008895c5b58e27fbb669623ab28ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga7c213cc89d01ec9cdbaa3356698a86ce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga7c213cc89d01ec9cdbaa3356698a86ce">MAX_ERROR</a>&#160;&#160;&#160;100.0    /* Artifical error maximum                              */</td></tr>
<tr class="separator:ga7c213cc89d01ec9cdbaa3356698a86ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0d288a400b18620bab417c0911c78811"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga0d288a400b18620bab417c0911c78811">ZERO_THRESHOLD</a>&#160;&#160;&#160;1.0e-9    /* Floating point threshold for zero detection          */</td></tr>
<tr class="separator:ga0d288a400b18620bab417c0911c78811"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab2bb44bef96ff160997daa91687a515d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gab2bb44bef96ff160997daa91687a515d">CONTROL_MDIV_BITS</a>&#160;&#160;&#160;3        /* Denominator of correction term                       */</td></tr>
<tr class="separator:gab2bb44bef96ff160997daa91687a515d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89304adb8322c6e4d302c71736a8aa8f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga89304adb8322c6e4d302c71736a8aa8f">CONTROL_NDIV_BITS</a>&#160;&#160;&#160;3        /* Numerator of correction term                         */</td></tr>
<tr class="separator:ga89304adb8322c6e4d302c71736a8aa8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga90f7bbc44c6e83fcc818895b327dad16"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga90f7bbc44c6e83fcc818895b327dad16">CONTROL_POSTDIV_BITS</a>&#160;&#160;&#160;5        /* Post-Divider                                         */</td></tr>
<tr class="separator:ga90f7bbc44c6e83fcc818895b327dad16"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeeaa4722266f828575690b7a8198f06b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gaeeaa4722266f828575690b7a8198f06b">CONTROL_MFG_BITS</a>&#160;&#160;&#160;3        /* Must Be Zero                                         */</td></tr>
<tr class="separator:gaeeaa4722266f828575690b7a8198f06b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4f2ba38e0b428ad44e34bdeb86997c6c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga4f2ba38e0b428ad44e34bdeb86997c6c">CONTROL_P_BITS</a>&#160;&#160;&#160;4        /* Integer part of fractional frequency                 */</td></tr>
<tr class="separator:ga4f2ba38e0b428ad44e34bdeb86997c6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6f1d33a3b66de0af022d7220744730c2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga6f1d33a3b66de0af022d7220744730c2">CONTROL_QPM1_BITS</a>&#160;&#160;&#160;5        /* Value for Q(p-1) term of fractional frequency        */</td></tr>
<tr class="separator:ga6f1d33a3b66de0af022d7220744730c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2bf644316e534d1809d5f34e64fa82b4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga2bf644316e534d1809d5f34e64fa82b4">CONTROL_QP_BITS</a>&#160;&#160;&#160;5        /* Value for Q(p) term of fractional frequency          */</td></tr>
<tr class="separator:ga2bf644316e534d1809d5f34e64fa82b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacb0fbea34f8af60d31e21e38fdecc179"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gacb0fbea34f8af60d31e21e38fdecc179">CONTROL_PREAMBLE_BITS</a>&#160;&#160;&#160;4        /* Must Be Zero                                         */</td></tr>
<tr class="separator:gacb0fbea34f8af60d31e21e38fdecc179"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga10b8efb38f7365a86997b787e987a8f8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga10b8efb38f7365a86997b787e987a8f8">CONTROL_MDIV_SHIFT</a>&#160;&#160;&#160;0        /* Denominator of correction term                       */</td></tr>
<tr class="separator:ga10b8efb38f7365a86997b787e987a8f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8a6eeeaab8ad2d1f6c4f9faeab9c38d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga8a6eeeaab8ad2d1f6c4f9faeab9c38d5">CONTROL_NDIV_SHIFT</a>&#160;&#160;&#160;3        /* Numerator of correction term                         */</td></tr>
<tr class="separator:ga8a6eeeaab8ad2d1f6c4f9faeab9c38d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gabb1acce6b2bea3fdb69992bf9af6e249"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gabb1acce6b2bea3fdb69992bf9af6e249">CONTROL_POSTDIV_SHIFT</a>&#160;&#160;&#160;6        /* Post-Divider                                         */</td></tr>
<tr class="separator:gabb1acce6b2bea3fdb69992bf9af6e249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga80f7bbc9ef9ca7e45e6f2c050528af6b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga80f7bbc9ef9ca7e45e6f2c050528af6b">CONTROL_MFG_SHIFT</a>&#160;&#160;&#160;11        /* Must Be Zero                                         */</td></tr>
<tr class="separator:ga80f7bbc9ef9ca7e45e6f2c050528af6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaecc281ac9a85b842baef7f0e3d9ad5fe"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gaecc281ac9a85b842baef7f0e3d9ad5fe">CONTROL_P_SHIFT</a>&#160;&#160;&#160;14        /* Integer part of fractional frequency                 */</td></tr>
<tr class="separator:gaecc281ac9a85b842baef7f0e3d9ad5fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga49ab24588b7ce39f2d8f6bdd89898324"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga49ab24588b7ce39f2d8f6bdd89898324">CONTROL_QPM1_SHIFT</a>&#160;&#160;&#160;18        /* Value for Q(p-1) term of fractional frequency        */</td></tr>
<tr class="separator:ga49ab24588b7ce39f2d8f6bdd89898324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5f146a143e408be0fc1f3cfe933aada2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga5f146a143e408be0fc1f3cfe933aada2">CONTROL_QP_SHIFT</a>&#160;&#160;&#160;23        /* Value for Q(p) term of fractional frequency          */</td></tr>
<tr class="separator:ga5f146a143e408be0fc1f3cfe933aada2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9e59d92df51ad3f1edeb63822c2b4dfc"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga9e59d92df51ad3f1edeb63822c2b4dfc">CONTROL_PREAMBLE_SHIFT</a>&#160;&#160;&#160;28        /* Must Be Zero                                         */</td></tr>
<tr class="separator:ga9e59d92df51ad3f1edeb63822c2b4dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad90524aaa3787cca45eafcb147cb4346"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gad90524aaa3787cca45eafcb147cb4346">CONTROL_MDIV_MASK</a>&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#gab2bb44bef96ff160997daa91687a515d">CONTROL_MDIV_BITS</a>)     - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#ga10b8efb38f7365a86997b787e987a8f8">CONTROL_MDIV_SHIFT</a>)</td></tr>
<tr class="separator:gad90524aaa3787cca45eafcb147cb4346"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae735d7fd3e8f4981dbb3bd337df282f5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gae735d7fd3e8f4981dbb3bd337df282f5">CONTROL_NDIV_MASK</a>&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#ga89304adb8322c6e4d302c71736a8aa8f">CONTROL_NDIV_BITS</a>)     - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#ga8a6eeeaab8ad2d1f6c4f9faeab9c38d5">CONTROL_NDIV_SHIFT</a>)</td></tr>
<tr class="separator:gae735d7fd3e8f4981dbb3bd337df282f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2353751d1a178b2f08a5444c176ba82b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga2353751d1a178b2f08a5444c176ba82b">CONTROL_POSTDIV_MASK</a>&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#ga90f7bbc44c6e83fcc818895b327dad16">CONTROL_POSTDIV_BITS</a>)  - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#gabb1acce6b2bea3fdb69992bf9af6e249">CONTROL_POSTDIV_SHIFT</a>)</td></tr>
<tr class="separator:ga2353751d1a178b2f08a5444c176ba82b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga117a878f86422dd7e98fbeb5958592d3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga117a878f86422dd7e98fbeb5958592d3">CONTROL_MFG_MASK</a>&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#gaeeaa4722266f828575690b7a8198f06b">CONTROL_MFG_BITS</a>)      - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#ga80f7bbc9ef9ca7e45e6f2c050528af6b">CONTROL_MFG_SHIFT</a>)</td></tr>
<tr class="separator:ga117a878f86422dd7e98fbeb5958592d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga90fd6e42e0570a89df2d2395999befd7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga90fd6e42e0570a89df2d2395999befd7">CONTROL_P_MASK</a>&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#ga4f2ba38e0b428ad44e34bdeb86997c6c">CONTROL_P_BITS</a>)        - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#gaecc281ac9a85b842baef7f0e3d9ad5fe">CONTROL_P_SHIFT</a>)</td></tr>
<tr class="separator:ga90fd6e42e0570a89df2d2395999befd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga194fca1519e1b595ac435efc2139cbc6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga194fca1519e1b595ac435efc2139cbc6">CONTROL_QPM1_MASK</a>&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#ga6f1d33a3b66de0af022d7220744730c2">CONTROL_QPM1_BITS</a>)     - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#ga49ab24588b7ce39f2d8f6bdd89898324">CONTROL_QPM1_SHIFT</a>)</td></tr>
<tr class="separator:ga194fca1519e1b595ac435efc2139cbc6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaced1549e7d5fa7b5e09eda9aea9f51da"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gaced1549e7d5fa7b5e09eda9aea9f51da">CONTROL_QP_MASK</a>&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#ga2bf644316e534d1809d5f34e64fa82b4">CONTROL_QP_BITS</a>)       - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#ga5f146a143e408be0fc1f3cfe933aada2">CONTROL_QP_SHIFT</a>)</td></tr>
<tr class="separator:gaced1549e7d5fa7b5e09eda9aea9f51da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga89aacdb8108467e0ed6c4d30d5cd564c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga89aacdb8108467e0ed6c4d30d5cd564c">CONTROL_PREAMBLE_MASK</a>&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#gacb0fbea34f8af60d31e21e38fdecc179">CONTROL_PREAMBLE_BITS</a>) - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#ga9e59d92df51ad3f1edeb63822c2b4dfc">CONTROL_PREAMBLE_SHIFT</a>)</td></tr>
<tr class="separator:ga89aacdb8108467e0ed6c4d30d5cd564c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga83d4b245bfc745625931be5e5c180bd8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga83d4b245bfc745625931be5e5c180bd8">CORRECTION_DIV_14</a>&#160;&#160;&#160;5       /* Numerator or denominator of 14                        */</td></tr>
<tr class="separator:ga83d4b245bfc745625931be5e5c180bd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab28c05ad71e7092b09d3adfc9d18b580"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gab28c05ad71e7092b09d3adfc9d18b580">CORRECTION_DIV_15</a>&#160;&#160;&#160;7       /* Numerator or denominator of 15                        */</td></tr>
<tr class="separator:gab28c05ad71e7092b09d3adfc9d18b580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga47a5cefce74a8ed04e6594f23c96db12"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga47a5cefce74a8ed04e6594f23c96db12">CORRECTION_DIV_16</a>&#160;&#160;&#160;1       /* Numerator or denominator of 16                        */</td></tr>
<tr class="separator:ga47a5cefce74a8ed04e6594f23c96db12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9a4417ab2fd5038ec86ed433b20c39ec"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga9a4417ab2fd5038ec86ed433b20c39ec">CORRECTION_DIV_17</a>&#160;&#160;&#160;3       /* Numerator or denominator of 17                        */</td></tr>
<tr class="separator:ga9a4417ab2fd5038ec86ed433b20c39ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac43f6b768ccdb9edfb617224fda9e029"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gac43f6b768ccdb9edfb617224fda9e029">CORRECTION_DIV_18</a>&#160;&#160;&#160;2       /* Numerator or denominator of 18                        */</td></tr>
<tr class="separator:gac43f6b768ccdb9edfb617224fda9e029"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga62680d342851a06998f6006d03f59335"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga62680d342851a06998f6006d03f59335">CORRECTION_DIV_31</a>&#160;&#160;&#160;4       /* Numerator or denominator of 31                        */</td></tr>
<tr class="separator:ga62680d342851a06998f6006d03f59335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga899d87654c8f053f636c88d46feb417b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga899d87654c8f053f636c88d46feb417b">CORRECTION_DIV_32</a>&#160;&#160;&#160;6       /* Numerator or denominator of 32                        */</td></tr>
<tr class="separator:ga899d87654c8f053f636c88d46feb417b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gae10824b00b8a005d97c74a11cdc9922b"><td class="memItemLeft" align="right" valign="top">epicsShareExtern epicsStatus&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gae10824b00b8a005d97c74a11cdc9922b">mrfSetEventClockSpeed</a> (epicsFloat64 InputClockSpeed, epicsUInt32 InputControlWord, epicsFloat64 ReferenceFreq, epicsFloat64 *OutputClockSpeed, epicsUInt32 *OutputControlWord, epicsInt32 PrintFlag)</td></tr>
<tr class="separator:gae10824b00b8a005d97c74a11cdc9922b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae361c0306ceb8ef7701c8bff663c56e3"><td class="memItemLeft" align="right" valign="top">epicsShareExtern epicsUInt32&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#gae361c0306ceb8ef7701c8bff663c56e3">FracSynthControlWord</a> (epicsFloat64 DesiredFreq, epicsFloat64 ReferenceFreq, epicsInt32 debugFlag, epicsFloat64 *Error)</td></tr>
<tr class="separator:gae361c0306ceb8ef7701c8bff663c56e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga42a0aecda942f6b758fbace9d8b3cdaa"><td class="memItemLeft" align="right" valign="top">epicsShareExtern epicsFloat64&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga42a0aecda942f6b758fbace9d8b3cdaa">FracSynthAnalyze</a> (epicsUInt32 ControlWord, epicsFloat64 ReferenceFreq, epicsInt32 PrintFlag)</td></tr>
<tr class="separator:ga42a0aecda942f6b758fbace9d8b3cdaa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga21f70b7c926c618d86b7320e33d15e66"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__mrf_common.html#ga21f70b7c926c618d86b7320e33d15e66">epicsExportRegistrar</a> (FracSynthRegistrar)</td></tr>
<tr class="separator:ga21f70b7c926c618d86b7320e33d15e66"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="gab2bb44bef96ff160997daa91687a515d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab2bb44bef96ff160997daa91687a515d">&#9670;&nbsp;</a></span>CONTROL_MDIV_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_MDIV_BITS&#160;&#160;&#160;3        /* Denominator of correction term                       */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00139">139</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="gad90524aaa3787cca45eafcb147cb4346"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad90524aaa3787cca45eafcb147cb4346">&#9670;&nbsp;</a></span>CONTROL_MDIV_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_MDIV_MASK&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#gab2bb44bef96ff160997daa91687a515d">CONTROL_MDIV_BITS</a>)     - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#ga10b8efb38f7365a86997b787e987a8f8">CONTROL_MDIV_SHIFT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00165">165</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga10b8efb38f7365a86997b787e987a8f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga10b8efb38f7365a86997b787e987a8f8">&#9670;&nbsp;</a></span>CONTROL_MDIV_SHIFT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_MDIV_SHIFT&#160;&#160;&#160;0        /* Denominator of correction term                       */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00152">152</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="gaeeaa4722266f828575690b7a8198f06b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaeeaa4722266f828575690b7a8198f06b">&#9670;&nbsp;</a></span>CONTROL_MFG_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_MFG_BITS&#160;&#160;&#160;3        /* Must Be Zero                                         */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00142">142</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga117a878f86422dd7e98fbeb5958592d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga117a878f86422dd7e98fbeb5958592d3">&#9670;&nbsp;</a></span>CONTROL_MFG_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_MFG_MASK&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#gaeeaa4722266f828575690b7a8198f06b">CONTROL_MFG_BITS</a>)      - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#ga80f7bbc9ef9ca7e45e6f2c050528af6b">CONTROL_MFG_SHIFT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00168">168</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga80f7bbc9ef9ca7e45e6f2c050528af6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga80f7bbc9ef9ca7e45e6f2c050528af6b">&#9670;&nbsp;</a></span>CONTROL_MFG_SHIFT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_MFG_SHIFT&#160;&#160;&#160;11        /* Must Be Zero                                         */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00155">155</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga89304adb8322c6e4d302c71736a8aa8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89304adb8322c6e4d302c71736a8aa8f">&#9670;&nbsp;</a></span>CONTROL_NDIV_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_NDIV_BITS&#160;&#160;&#160;3        /* Numerator of correction term                         */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00140">140</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="gae735d7fd3e8f4981dbb3bd337df282f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae735d7fd3e8f4981dbb3bd337df282f5">&#9670;&nbsp;</a></span>CONTROL_NDIV_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_NDIV_MASK&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#ga89304adb8322c6e4d302c71736a8aa8f">CONTROL_NDIV_BITS</a>)     - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#ga8a6eeeaab8ad2d1f6c4f9faeab9c38d5">CONTROL_NDIV_SHIFT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00166">166</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga8a6eeeaab8ad2d1f6c4f9faeab9c38d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8a6eeeaab8ad2d1f6c4f9faeab9c38d5">&#9670;&nbsp;</a></span>CONTROL_NDIV_SHIFT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_NDIV_SHIFT&#160;&#160;&#160;3        /* Numerator of correction term                         */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00153">153</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga4f2ba38e0b428ad44e34bdeb86997c6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4f2ba38e0b428ad44e34bdeb86997c6c">&#9670;&nbsp;</a></span>CONTROL_P_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_P_BITS&#160;&#160;&#160;4        /* Integer part of fractional frequency                 */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00143">143</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga90fd6e42e0570a89df2d2395999befd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga90fd6e42e0570a89df2d2395999befd7">&#9670;&nbsp;</a></span>CONTROL_P_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_P_MASK&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#ga4f2ba38e0b428ad44e34bdeb86997c6c">CONTROL_P_BITS</a>)        - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#gaecc281ac9a85b842baef7f0e3d9ad5fe">CONTROL_P_SHIFT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00169">169</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="gaecc281ac9a85b842baef7f0e3d9ad5fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaecc281ac9a85b842baef7f0e3d9ad5fe">&#9670;&nbsp;</a></span>CONTROL_P_SHIFT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_P_SHIFT&#160;&#160;&#160;14        /* Integer part of fractional frequency                 */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00156">156</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga90f7bbc44c6e83fcc818895b327dad16"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga90f7bbc44c6e83fcc818895b327dad16">&#9670;&nbsp;</a></span>CONTROL_POSTDIV_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_POSTDIV_BITS&#160;&#160;&#160;5        /* Post-Divider                                         */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00141">141</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga2353751d1a178b2f08a5444c176ba82b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2353751d1a178b2f08a5444c176ba82b">&#9670;&nbsp;</a></span>CONTROL_POSTDIV_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_POSTDIV_MASK&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#ga90f7bbc44c6e83fcc818895b327dad16">CONTROL_POSTDIV_BITS</a>)  - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#gabb1acce6b2bea3fdb69992bf9af6e249">CONTROL_POSTDIV_SHIFT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00167">167</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="gabb1acce6b2bea3fdb69992bf9af6e249"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabb1acce6b2bea3fdb69992bf9af6e249">&#9670;&nbsp;</a></span>CONTROL_POSTDIV_SHIFT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_POSTDIV_SHIFT&#160;&#160;&#160;6        /* Post-Divider                                         */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00154">154</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="gacb0fbea34f8af60d31e21e38fdecc179"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacb0fbea34f8af60d31e21e38fdecc179">&#9670;&nbsp;</a></span>CONTROL_PREAMBLE_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_PREAMBLE_BITS&#160;&#160;&#160;4        /* Must Be Zero                                         */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00146">146</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga89aacdb8108467e0ed6c4d30d5cd564c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga89aacdb8108467e0ed6c4d30d5cd564c">&#9670;&nbsp;</a></span>CONTROL_PREAMBLE_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_PREAMBLE_MASK&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#gacb0fbea34f8af60d31e21e38fdecc179">CONTROL_PREAMBLE_BITS</a>) - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#ga9e59d92df51ad3f1edeb63822c2b4dfc">CONTROL_PREAMBLE_SHIFT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00172">172</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga9e59d92df51ad3f1edeb63822c2b4dfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9e59d92df51ad3f1edeb63822c2b4dfc">&#9670;&nbsp;</a></span>CONTROL_PREAMBLE_SHIFT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_PREAMBLE_SHIFT&#160;&#160;&#160;28        /* Must Be Zero                                         */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00159">159</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga2bf644316e534d1809d5f34e64fa82b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2bf644316e534d1809d5f34e64fa82b4">&#9670;&nbsp;</a></span>CONTROL_QP_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_QP_BITS&#160;&#160;&#160;5        /* Value for Q(p) term of fractional frequency          */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00145">145</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="gaced1549e7d5fa7b5e09eda9aea9f51da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaced1549e7d5fa7b5e09eda9aea9f51da">&#9670;&nbsp;</a></span>CONTROL_QP_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_QP_MASK&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#ga2bf644316e534d1809d5f34e64fa82b4">CONTROL_QP_BITS</a>)       - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#ga5f146a143e408be0fc1f3cfe933aada2">CONTROL_QP_SHIFT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00171">171</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga5f146a143e408be0fc1f3cfe933aada2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5f146a143e408be0fc1f3cfe933aada2">&#9670;&nbsp;</a></span>CONTROL_QP_SHIFT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_QP_SHIFT&#160;&#160;&#160;23        /* Value for Q(p) term of fractional frequency          */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00158">158</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga6f1d33a3b66de0af022d7220744730c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6f1d33a3b66de0af022d7220744730c2">&#9670;&nbsp;</a></span>CONTROL_QPM1_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_QPM1_BITS&#160;&#160;&#160;5        /* Value for Q(p-1) term of fractional frequency        */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00144">144</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga194fca1519e1b595ac435efc2139cbc6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga194fca1519e1b595ac435efc2139cbc6">&#9670;&nbsp;</a></span>CONTROL_QPM1_MASK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_QPM1_MASK&#160;&#160;&#160;(((1 &lt;&lt; <a class="el" href="group__mrf_common.html#ga6f1d33a3b66de0af022d7220744730c2">CONTROL_QPM1_BITS</a>)     - 1) &lt;&lt; <a class="el" href="group__mrf_common.html#ga49ab24588b7ce39f2d8f6bdd89898324">CONTROL_QPM1_SHIFT</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00170">170</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga49ab24588b7ce39f2d8f6bdd89898324"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga49ab24588b7ce39f2d8f6bdd89898324">&#9670;&nbsp;</a></span>CONTROL_QPM1_SHIFT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONTROL_QPM1_SHIFT&#160;&#160;&#160;18        /* Value for Q(p-1) term of fractional frequency        */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00157">157</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga83d4b245bfc745625931be5e5c180bd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga83d4b245bfc745625931be5e5c180bd8">&#9670;&nbsp;</a></span>CORRECTION_DIV_14</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CORRECTION_DIV_14&#160;&#160;&#160;5       /* Numerator or denominator of 14                        */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00178">178</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="gab28c05ad71e7092b09d3adfc9d18b580"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab28c05ad71e7092b09d3adfc9d18b580">&#9670;&nbsp;</a></span>CORRECTION_DIV_15</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CORRECTION_DIV_15&#160;&#160;&#160;7       /* Numerator or denominator of 15                        */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00179">179</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga47a5cefce74a8ed04e6594f23c96db12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga47a5cefce74a8ed04e6594f23c96db12">&#9670;&nbsp;</a></span>CORRECTION_DIV_16</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CORRECTION_DIV_16&#160;&#160;&#160;1       /* Numerator or denominator of 16                        */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00180">180</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga9a4417ab2fd5038ec86ed433b20c39ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9a4417ab2fd5038ec86ed433b20c39ec">&#9670;&nbsp;</a></span>CORRECTION_DIV_17</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CORRECTION_DIV_17&#160;&#160;&#160;3       /* Numerator or denominator of 17                        */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00181">181</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="gac43f6b768ccdb9edfb617224fda9e029"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac43f6b768ccdb9edfb617224fda9e029">&#9670;&nbsp;</a></span>CORRECTION_DIV_18</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CORRECTION_DIV_18&#160;&#160;&#160;2       /* Numerator or denominator of 18                        */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00182">182</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga62680d342851a06998f6006d03f59335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga62680d342851a06998f6006d03f59335">&#9670;&nbsp;</a></span>CORRECTION_DIV_31</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CORRECTION_DIV_31&#160;&#160;&#160;4       /* Numerator or denominator of 31                        */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00183">183</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga899d87654c8f053f636c88d46feb417b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga899d87654c8f053f636c88d46feb417b">&#9670;&nbsp;</a></span>CORRECTION_DIV_32</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CORRECTION_DIV_32&#160;&#160;&#160;6       /* Numerator or denominator of 32                        */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00184">184</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="gad5aeca1a1a793c8ba18f85cbac89e768"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad5aeca1a1a793c8ba18f85cbac89e768">&#9670;&nbsp;</a></span>DEBUG_PRINT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_PRINT&#160;&#160;&#160;/* Debug printing always enabled for this module        */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00092">92</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga6af78dc3b0b89a75db6f2d59ab9589ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga6af78dc3b0b89a75db6f2d59ab9589ff">&#9670;&nbsp;</a></span>MAX_CORRECTION_RATIO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_CORRECTION_RATIO&#160;&#160;&#160;(17./14.)  /* Maximum value for correction term.                   */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00116">116</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga7c213cc89d01ec9cdbaa3356698a86ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7c213cc89d01ec9cdbaa3356698a86ce">&#9670;&nbsp;</a></span>MAX_ERROR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_ERROR&#160;&#160;&#160;100.0    /* Artifical error maximum                              */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00127">127</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="gabef9b0318c864d32d39586183a047d94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gabef9b0318c864d32d39586183a047d94">&#9670;&nbsp;</a></span>MAX_FRAC_DIVISOR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_FRAC_DIVISOR&#160;&#160;&#160;31    /* Maximum divisor for fractional frequency value       */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00120">120</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga32482de274074ad01b9ad07b5a77e6e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga32482de274074ad01b9ad07b5a77e6e2">&#9670;&nbsp;</a></span>MAX_VCO_FREQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_VCO_FREQ&#160;&#160;&#160;729.0    /* Maximum frequency for voltage-controlled oscillator  */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00117">117</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="gac0f6f780b72f7f28dde57624f5a1ef85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac0f6f780b72f7f28dde57624f5a1ef85">&#9670;&nbsp;</a></span>MIN_P_VALUE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN_P_VALUE&#160;&#160;&#160;17    /* Minimum val for integer part of fractional frequency */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00119">119</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga4028643367a81118579bb9ff00dbb317"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4028643367a81118579bb9ff00dbb317">&#9670;&nbsp;</a></span>MIN_VCO_FREQ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MIN_VCO_FREQ&#160;&#160;&#160;540.0    /* Minimum frequency for voltage-controlled oscillator  */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00118">118</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga241008895c5b58e27fbb669623ab28ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga241008895c5b58e27fbb669623ab28ce">&#9670;&nbsp;</a></span>NUM_CORRECTION_VALS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_CORRECTION_VALS&#160;&#160;&#160;8    /* Number of correction value codes                     */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00125">125</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga179cb66a9388422a1abb1514ab4dd468"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga179cb66a9388422a1abb1514ab4dd468">&#9670;&nbsp;</a></span>NUM_CORRECTIONS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_CORRECTIONS&#160;&#160;&#160;23    /* Number of valid correction values (plus <a class="el" href="linkoptions_test_8c.html#a40086d8cf0e43ebc12c1b1a7fc81945d">one</a>)         */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00124">124</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="gaa60f29977f11d5548eb3f37f879e6fa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa60f29977f11d5548eb3f37f879e6fa2">&#9670;&nbsp;</a></span>NUM_POST_DIVIDE_VALS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_POST_DIVIDE_VALS&#160;&#160;&#160;32    /* Number of post-divider codes                         */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00123">123</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga67676a1360dc48867462b00234056f99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga67676a1360dc48867462b00234056f99">&#9670;&nbsp;</a></span>NUM_POST_DIVIDES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NUM_POST_DIVIDES&#160;&#160;&#160;31    /* Number of unique post-divider values                 */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00122">122</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<a id="ga0d288a400b18620bab417c0911c78811"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0d288a400b18620bab417c0911c78811">&#9670;&nbsp;</a></span>ZERO_THRESHOLD</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ZERO_THRESHOLD&#160;&#160;&#160;1.0e-9    /* Floating point threshold for zero detection          */</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00128">128</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga21f70b7c926c618d86b7320e33d15e66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga21f70b7c926c618d86b7320e33d15e66">&#9670;&nbsp;</a></span>epicsExportRegistrar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">epicsExportRegistrar </td>
          <td>(</td>
          <td class="paramtype">FracSynthRegistrar&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ga42a0aecda942f6b758fbace9d8b3cdaa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga42a0aecda942f6b758fbace9d8b3cdaa">&#9670;&nbsp;</a></span>FracSynthAnalyze()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">epicsShareExtern epicsFloat64 FracSynthAnalyze </td>
          <td>(</td>
          <td class="paramtype">epicsUInt32&#160;</td>
          <td class="paramname"><em>ControlWord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">epicsFloat64&#160;</td>
          <td class="paramname"><em>ReferenceFreq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">epicsInt32&#160;</td>
          <td class="paramname"><em>PrintFlag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Description:</dt><dd>This routine will take a bit pattern representing an SY87739L fractional synthesizer control word, break it down into its constituent parts, and return the effective output frequency (in MegaHertz) that the control word will generate. Depending on the value of the "PrintFlag" parameter, it will also display the constituent parts of the the control word and the resulting values that make up the output frequency, and analyze the control word for programming errors.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ControlWord</td><td>= (input) The control word bit pattern to analyze. </td></tr>
    <tr><td class="paramname">ReferenceFreq</td><td>= (input) SY87739L input reference frequency in MegaHertz. </td></tr>
    <tr><td class="paramname">PrintFlag</td><td>= (input) Flag to control output messages. <a class="el" href="class_output.html">Output</a> levels correspond to the DEBUGPRINT output levels:<br />
 DP_NONE (0) = No printed output, just return the effective output frequency.<br />
 DP_ERROR (2) = Display any programming errors detected in the control word<br />
 DP_DEBUG (5) = Display the actual values of the fields in the control word, along with the constituent parts of the output frequency (VCO frequency, correction term, reference freq.)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Implicit Inputs:</dt><dd><em>CorrectionValList</em> = (<a class="el" href="struct_correction_val_struct.html">CorrectionValStruct</a>) Array to translate correction term components from their coded values to actual values and classes. <em>PostDivideValList</em> = (epicsInt32) Array to translate the post-divider field from its coded value to its actual value.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the output frequency generated by the control word.<br />
 Returns 0.0 if the analysis discovered programming errors in the control word. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00844">844</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;{</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="comment">    *  Local Variables</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    epicsFloat64   CorrectionTerm;</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    epicsFloat64   EffectiveFreq = 0.0;         <span class="comment">/* Computed effective output frequency            */</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordtype">int</span>   Error = 0;          <span class="comment">/* Error flag from control word analysis          */</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    epicsInt32     i;                           <span class="comment">/* Local loop counter                             */</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    epicsUInt32    MDiv;                        <span class="comment">/* Coded value of the correction term denominator */</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    epicsInt32     MDivClass;                   <span class="comment">/* Class designator of the correction denominator */</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    epicsFloat64   MDivVal;                     <span class="comment">/* Actual value of the correction term denominator*/</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    epicsUInt32    Mfg;                         <span class="comment">/* MFG field extracted from the control word      */</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    epicsUInt32    NDiv;                        <span class="comment">/* Coded value of the correction term numerator   */</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    epicsInt32     NDivClass;                   <span class="comment">/* Class designator of the correction numerator   */</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    epicsFloat64   NDivVal;                     <span class="comment">/* Actual value of the correction term numerator  */</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    epicsUInt32    P;                           <span class="comment">/* Coded value of the frac freq integer component */</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    epicsFloat64   PVal;                        <span class="comment">/* Actual value of the frac freq integer component*/</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    epicsUInt32    PostDivide;                  <span class="comment">/* Coded value of the post-divider                */</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    epicsFloat64   PostDivideVal;               <span class="comment">/* Actual value of the post-divider               */</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    epicsUInt32    Preamble;                    <span class="comment">/* Preamble field extracted from the control word */</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    epicsUInt32    Qp;                          <span class="comment">/* Number of times to divide by P                 */</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    epicsUInt32    Qpm1;                        <span class="comment">/* Number of times to divide by P-1               */</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    epicsFloat64   VcoFreq;                     <span class="comment">/* Computed VCO frequency                         */</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="comment">    * Decompose the control word into its constituent elements</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;    Preamble   = (ControlWord &amp; <a class="code" href="group__mrf_common.html#ga89aacdb8108467e0ed6c4d30d5cd564c">CONTROL_PREAMBLE_MASK</a>) &gt;&gt; <a class="code" href="group__mrf_common.html#ga9e59d92df51ad3f1edeb63822c2b4dfc">CONTROL_PREAMBLE_SHIFT</a>;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    Qp         = (ControlWord &amp; <a class="code" href="group__mrf_common.html#gaced1549e7d5fa7b5e09eda9aea9f51da">CONTROL_QP_MASK</a>)       &gt;&gt; <a class="code" href="group__mrf_common.html#ga5f146a143e408be0fc1f3cfe933aada2">CONTROL_QP_SHIFT</a>;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    Qpm1       = (ControlWord &amp; <a class="code" href="group__mrf_common.html#ga194fca1519e1b595ac435efc2139cbc6">CONTROL_QPM1_MASK</a>)     &gt;&gt; <a class="code" href="group__mrf_common.html#ga49ab24588b7ce39f2d8f6bdd89898324">CONTROL_QPM1_SHIFT</a>;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    P          = (ControlWord &amp; <a class="code" href="group__mrf_common.html#ga90fd6e42e0570a89df2d2395999befd7">CONTROL_P_MASK</a>)        &gt;&gt; <a class="code" href="group__mrf_common.html#gaecc281ac9a85b842baef7f0e3d9ad5fe">CONTROL_P_SHIFT</a>;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    Mfg        = (ControlWord &amp; <a class="code" href="group__mrf_common.html#ga117a878f86422dd7e98fbeb5958592d3">CONTROL_MFG_MASK</a>)      &gt;&gt; <a class="code" href="group__mrf_common.html#ga80f7bbc9ef9ca7e45e6f2c050528af6b">CONTROL_MFG_SHIFT</a>;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    PostDivide = (ControlWord &amp; <a class="code" href="group__mrf_common.html#ga2353751d1a178b2f08a5444c176ba82b">CONTROL_POSTDIV_MASK</a>)  &gt;&gt; <a class="code" href="group__mrf_common.html#gabb1acce6b2bea3fdb69992bf9af6e249">CONTROL_POSTDIV_SHIFT</a>;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    NDiv       = (ControlWord &amp; <a class="code" href="group__mrf_common.html#gae735d7fd3e8f4981dbb3bd337df282f5">CONTROL_NDIV_MASK</a>)     &gt;&gt; <a class="code" href="group__mrf_common.html#ga8a6eeeaab8ad2d1f6c4f9faeab9c38d5">CONTROL_NDIV_SHIFT</a>;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    MDiv       = (ControlWord &amp; <a class="code" href="group__mrf_common.html#gad90524aaa3787cca45eafcb147cb4346">CONTROL_MDIV_MASK</a>)     &gt;&gt; <a class="code" href="group__mrf_common.html#ga10b8efb38f7365a86997b787e987a8f8">CONTROL_MDIV_SHIFT</a>;</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="comment">    * Translate the elements of the correction term fraction from their encoded values</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="comment">    * to their actual values.</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;    MDivVal = (double)CorrectionValList[MDiv].Value;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;    NDivVal = (double)CorrectionValList[NDiv].Value;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">    * Obtain the class number for each of the elements of the correction term fraction.</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;    MDivClass = CorrectionValList[MDiv].<a class="code" href="struct_correction_val_struct.html#a9e1715d65931c40a70b3e3baa319c5d0">Class</a>;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    NDivClass = CorrectionValList[NDiv].<a class="code" href="struct_correction_val_struct.html#a9e1715d65931c40a70b3e3baa319c5d0">Class</a>;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">    * Translate the integer part (P) if the fractional frequency and the post-divider from</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment">    * their encoded values to their actual values.</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;    PVal = (double)(P + <a class="code" href="group__mrf_common.html#gac0f6f780b72f7f28dde57624f5a1ef85">MIN_P_VALUE</a>);</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    PostDivideVal = (double)PostDivideValList[PostDivide];</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="comment">/**********************************************************************************************/</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="comment">/*  Check for fatal errors that would prevent us from completing the analysis                 */</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="comment">/**********************************************************************************************/</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#afeb648eb8d2d3c3754f00a0abd605320">DP_DEBUG</a>, PrintFlag,</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;               (<span class="stringliteral">&quot;Analysis of Control Word 0x%08X:\n&quot;</span>, ControlWord));</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">    * Check for fractional frequency denominator being zero.</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keywordflow">if</span> ((Qp + Qpm1) == 0) {</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#af46840b7d1e9fc3add9e7234d8ba5966">DP_FATAL</a>, PrintFlag, (<span class="stringliteral">&quot; *Error: Q(p) + Q(p-1) [%u + %u] is 0.\n&quot;</span>, Qp, Qpm1));</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        Error = 1;</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    }<span class="comment">/*end if fractional denominator is zero*/</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="comment">    * Abort if there are any fatal errors that would prevent us from computing the effective</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="comment">    * frequency.</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordflow">if</span> (Error) <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="comment">/**********************************************************************************************/</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="comment">/*  Analyze the control word                                                                  */</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">/**********************************************************************************************/</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="comment">    * Compute the components of the effective output frequency generated by this control word.</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    CorrectionTerm = NDivVal / MDivVal;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    VcoFreq =  (PVal - ((double)Qpm1 / (<span class="keywordtype">double</span>)(Qp + Qpm1))) * CorrectionTerm * ReferenceFreq;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    EffectiveFreq = VcoFreq / PostDivideVal;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="comment">    * Display the control word fields and how they combine to produce the effective output</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="comment">    * frequency.</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    Error = 0;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#afeb648eb8d2d3c3754f00a0abd605320">DP_DEBUG</a>, PrintFlag,</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;               (<span class="stringliteral">&quot;  P = %d,  Q(p) = %u,  Q(p-1) = %u,  Post Divider = %d\n&quot;</span>,</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;               (<span class="keywordtype">int</span>)PVal, Qp, Qpm1, (<span class="keywordtype">int</span>)PostDivideVal));</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#afeb648eb8d2d3c3754f00a0abd605320">DP_DEBUG</a>, PrintFlag,</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;               (<span class="stringliteral">&quot;  Correction Term (N/M) = %d/%d = %f,  Reference Frequency = %3.1f MHz.\n&quot;</span>,</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;               (<span class="keywordtype">int</span>)NDivVal, (<span class="keywordtype">int</span>)MDivVal, CorrectionTerm, ReferenceFreq));</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#afeb648eb8d2d3c3754f00a0abd605320">DP_DEBUG</a>, PrintFlag,</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;               (<span class="stringliteral">&quot;  VCO Frequency = %f MHz.  Effective Frequency = %15.12f MHz.\n&quot;</span>,</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;               VcoFreq, EffectiveFreq));</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="comment">/**********************************************************************************************/</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">/*  Check for error conditions                                                                */</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">/**********************************************************************************************/</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="comment">    * Check for preamble field not zero</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordflow">if</span> (Preamble != 0) {</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        Error = 1;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag,</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                   (<span class="stringliteral">&quot; *Error: PREAMBLE field (bits %d-%d) is 0x%X.\n&quot;</span>,</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                   <a class="code" href="group__mrf_common.html#ga9e59d92df51ad3f1edeb63822c2b4dfc">CONTROL_PREAMBLE_SHIFT</a>, <a class="code" href="group__mrf_common.html#ga9e59d92df51ad3f1edeb63822c2b4dfc">CONTROL_PREAMBLE_SHIFT</a>+<a class="code" href="group__mrf_common.html#gacb0fbea34f8af60d31e21e38fdecc179">CONTROL_PREAMBLE_BITS</a>-1,</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                   Preamble));</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag,</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                   (<span class="stringliteral">&quot;         Should be 0x0.\n&quot;</span>));</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    }<span class="comment">/*end if preamble field is not zero*/</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="comment">    * Check for MFG field not zero</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keywordflow">if</span> (Mfg != 0) {</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        Error = 1;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag,</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                   (<span class="stringliteral">&quot; *Error: MFG field (bits %d-%d) is 0x%X.\n&quot;</span>,</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                   <a class="code" href="group__mrf_common.html#ga80f7bbc9ef9ca7e45e6f2c050528af6b">CONTROL_MFG_SHIFT</a>, <a class="code" href="group__mrf_common.html#ga80f7bbc9ef9ca7e45e6f2c050528af6b">CONTROL_MFG_SHIFT</a>+<a class="code" href="group__mrf_common.html#gaeeaa4722266f828575690b7a8198f06b">CONTROL_MFG_BITS</a>-1, Mfg));</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag,</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                   (<span class="stringliteral">&quot;         Should be 0x0.\n&quot;</span>));</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    }<span class="comment">/*end if mfg field is not zero*/</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">    * Check for fractional denominator too big.</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">    * (one more than the maximum actually does seem to work, so we&#39;ll allow it to pass).</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="keywordflow">if</span> ((Qp + Qpm1) &gt; <a class="code" href="group__mrf_common.html#gabef9b0318c864d32d39586183a047d94">MAX_FRAC_DIVISOR</a>) {</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        <span class="keywordflow">if</span> ((Qp + Qpm1) &gt; (<a class="code" href="group__mrf_common.html#gabef9b0318c864d32d39586183a047d94">MAX_FRAC_DIVISOR</a> + 1))</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            Error = 1;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag,</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                   (<span class="stringliteral">&quot; *Error: Q(p) + Q(p-1) [%u + %u] is %u.\n&quot;</span>, Qp, Qpm1, (Qp+Qpm1)));</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag,</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                   (<span class="stringliteral">&quot;         Sum should be less than or equal to %d.\n&quot;</span>, <a class="code" href="group__mrf_common.html#gabef9b0318c864d32d39586183a047d94">MAX_FRAC_DIVISOR</a>));</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    }<span class="comment">/*end if fractional divisor is too large*/</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="comment">    * Check for correction term too big.</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">if</span> ((NDivVal / MDivVal) &gt; <a class="code" href="group__mrf_common.html#ga6af78dc3b0b89a75db6f2d59ab9589ff">MAX_CORRECTION_RATIO</a>) {</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        Error = 1;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag,</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;                   (<span class="stringliteral">&quot; *Error: Correction Term Ratio = (N/M) = (%d/%d) = %f is too big.\n&quot;</span>,</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                   (<span class="keywordtype">int</span>)NDivVal, (<span class="keywordtype">int</span>)MDivVal, (NDivVal/MDivVal)));</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag,</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;                   (<span class="stringliteral">&quot;         Should be less than (17/14) = %f\n&quot;</span>, <a class="code" href="group__mrf_common.html#ga6af78dc3b0b89a75db6f2d59ab9589ff">MAX_CORRECTION_RATIO</a>));</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    }<span class="comment">/*end if correction term ratio is too big*/</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="comment">    * Check for correction term numerator and denominator being from different classes.</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    <span class="keywordflow">if</span> (NDivClass != MDivClass) {</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        Error = 1;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag,</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                   (<span class="stringliteral">&quot; *Error: Correction Term numerator (%d) is not compatible with&quot;</span>,</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                   (<span class="keywordtype">int</span>)NDivVal));</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag,</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                   (<span class="stringliteral">&quot; Correction Term Denominator (%d).\n&quot;</span>, (<span class="keywordtype">int</span>)MDivVal));</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag,</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                   (<span class="stringliteral">&quot;         Valid numerator values are:&quot;</span>));</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <span class="keywordflow">for</span> (i=1;  i &lt; <a class="code" href="group__mrf_common.html#ga241008895c5b58e27fbb669623ab28ce">NUM_CORRECTION_VALS</a>;  i++) {</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            <span class="keywordflow">if</span> (CorrectionValList[i].Class == MDivClass)</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;                <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag, (<span class="stringliteral">&quot; %d&quot;</span>, CorrectionValList[i].Value));</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;        }<span class="comment">/*end search for valid numerators*/</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag, (<span class="stringliteral">&quot;.\n&quot;</span>));</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    }<span class="comment">/*end if correction term numerator/denominator pair is invalid*/</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="comment">    * Check for VCO frequency out of range</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    <span class="keywordflow">if</span> ((VcoFreq &gt; <a class="code" href="group__mrf_common.html#ga32482de274074ad01b9ad07b5a77e6e2">MAX_VCO_FREQ</a>) || (VcoFreq &lt; <a class="code" href="group__mrf_common.html#ga4028643367a81118579bb9ff00dbb317">MIN_VCO_FREQ</a>)) {</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        Error = 1;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag,</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                   (<span class="stringliteral">&quot; *Error: VCO Frequency (%f MHz.) is outside the valid range.\n&quot;</span>, VcoFreq));</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a>, PrintFlag,</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                   (<span class="stringliteral">&quot;         Should be between %5.1f MHz. and %5.1f MHz.\n&quot;</span>,</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                    <a class="code" href="group__mrf_common.html#ga4028643367a81118579bb9ff00dbb317">MIN_VCO_FREQ</a>, <a class="code" href="group__mrf_common.html#ga32482de274074ad01b9ad07b5a77e6e2">MAX_VCO_FREQ</a>));</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    }<span class="comment">/*end if VCO Frequency is out of range*/</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment">    * If the analysis did not uncover any serious errors, return the effective output frequency.</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    <span class="keywordflow">if</span> (Error) <span class="keywordflow">return</span> 0.0;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">else</span>       <span class="keywordflow">return</span> EffectiveFreq;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;}<span class="comment">/*end FracSynthAnalyze()*/</span></div><div class="ttc" id="group__mrf_common_html_gac0f6f780b72f7f28dde57624f5a1ef85"><div class="ttname"><a href="group__mrf_common.html#gac0f6f780b72f7f28dde57624f5a1ef85">MIN_P_VALUE</a></div><div class="ttdeci">#define MIN_P_VALUE</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00119">mrfFracSynth.c:119</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga5f146a143e408be0fc1f3cfe933aada2"><div class="ttname"><a href="group__mrf_common.html#ga5f146a143e408be0fc1f3cfe933aada2">CONTROL_QP_SHIFT</a></div><div class="ttdeci">#define CONTROL_QP_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00158">mrfFracSynth.c:158</a></div></div>
<div class="ttc" id="debug_print_8h_html_acb21e1590588b784857197e3e416673a"><div class="ttname"><a href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a></div><div class="ttdeci">#define DEBUGPRINT(interest, globalFlag, args)</div><div class="ttdef"><b>Definition:</b> <a href="debug_print_8h_source.html#l00102">debugPrint.h:102</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga8a6eeeaab8ad2d1f6c4f9faeab9c38d5"><div class="ttname"><a href="group__mrf_common.html#ga8a6eeeaab8ad2d1f6c4f9faeab9c38d5">CONTROL_NDIV_SHIFT</a></div><div class="ttdeci">#define CONTROL_NDIV_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00153">mrfFracSynth.c:153</a></div></div>
<div class="ttc" id="group__mrf_common_html_gaecc281ac9a85b842baef7f0e3d9ad5fe"><div class="ttname"><a href="group__mrf_common.html#gaecc281ac9a85b842baef7f0e3d9ad5fe">CONTROL_P_SHIFT</a></div><div class="ttdeci">#define CONTROL_P_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00156">mrfFracSynth.c:156</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga49ab24588b7ce39f2d8f6bdd89898324"><div class="ttname"><a href="group__mrf_common.html#ga49ab24588b7ce39f2d8f6bdd89898324">CONTROL_QPM1_SHIFT</a></div><div class="ttdeci">#define CONTROL_QPM1_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00157">mrfFracSynth.c:157</a></div></div>
<div class="ttc" id="struct_correction_val_struct_html_a9e1715d65931c40a70b3e3baa319c5d0"><div class="ttname"><a href="struct_correction_val_struct.html#a9e1715d65931c40a70b3e3baa319c5d0">CorrectionValStruct::Class</a></div><div class="ttdeci">epicsInt32 Class</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00213">mrfFracSynth.c:213</a></div></div>
<div class="ttc" id="group__mrf_common_html_gaeeaa4722266f828575690b7a8198f06b"><div class="ttname"><a href="group__mrf_common.html#gaeeaa4722266f828575690b7a8198f06b">CONTROL_MFG_BITS</a></div><div class="ttdeci">#define CONTROL_MFG_BITS</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00142">mrfFracSynth.c:142</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga89aacdb8108467e0ed6c4d30d5cd564c"><div class="ttname"><a href="group__mrf_common.html#ga89aacdb8108467e0ed6c4d30d5cd564c">CONTROL_PREAMBLE_MASK</a></div><div class="ttdeci">#define CONTROL_PREAMBLE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00172">mrfFracSynth.c:172</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga2353751d1a178b2f08a5444c176ba82b"><div class="ttname"><a href="group__mrf_common.html#ga2353751d1a178b2f08a5444c176ba82b">CONTROL_POSTDIV_MASK</a></div><div class="ttdeci">#define CONTROL_POSTDIV_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00167">mrfFracSynth.c:167</a></div></div>
<div class="ttc" id="group__mrf_common_html_gacb0fbea34f8af60d31e21e38fdecc179"><div class="ttname"><a href="group__mrf_common.html#gacb0fbea34f8af60d31e21e38fdecc179">CONTROL_PREAMBLE_BITS</a></div><div class="ttdeci">#define CONTROL_PREAMBLE_BITS</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00146">mrfFracSynth.c:146</a></div></div>
<div class="ttc" id="group__mrf_common_html_gabef9b0318c864d32d39586183a047d94"><div class="ttname"><a href="group__mrf_common.html#gabef9b0318c864d32d39586183a047d94">MAX_FRAC_DIVISOR</a></div><div class="ttdeci">#define MAX_FRAC_DIVISOR</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00120">mrfFracSynth.c:120</a></div></div>
<div class="ttc" id="group__mrf_common_html_gae735d7fd3e8f4981dbb3bd337df282f5"><div class="ttname"><a href="group__mrf_common.html#gae735d7fd3e8f4981dbb3bd337df282f5">CONTROL_NDIV_MASK</a></div><div class="ttdeci">#define CONTROL_NDIV_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00166">mrfFracSynth.c:166</a></div></div>
<div class="ttc" id="group__mrf_common_html_gaced1549e7d5fa7b5e09eda9aea9f51da"><div class="ttname"><a href="group__mrf_common.html#gaced1549e7d5fa7b5e09eda9aea9f51da">CONTROL_QP_MASK</a></div><div class="ttdeci">#define CONTROL_QP_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00171">mrfFracSynth.c:171</a></div></div>
<div class="ttc" id="group__mrf_common_html_gad90524aaa3787cca45eafcb147cb4346"><div class="ttname"><a href="group__mrf_common.html#gad90524aaa3787cca45eafcb147cb4346">CONTROL_MDIV_MASK</a></div><div class="ttdeci">#define CONTROL_MDIV_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00165">mrfFracSynth.c:165</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga10b8efb38f7365a86997b787e987a8f8"><div class="ttname"><a href="group__mrf_common.html#ga10b8efb38f7365a86997b787e987a8f8">CONTROL_MDIV_SHIFT</a></div><div class="ttdeci">#define CONTROL_MDIV_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00152">mrfFracSynth.c:152</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga4028643367a81118579bb9ff00dbb317"><div class="ttname"><a href="group__mrf_common.html#ga4028643367a81118579bb9ff00dbb317">MIN_VCO_FREQ</a></div><div class="ttdeci">#define MIN_VCO_FREQ</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00118">mrfFracSynth.c:118</a></div></div>
<div class="ttc" id="group__mrf_common_html_gabb1acce6b2bea3fdb69992bf9af6e249"><div class="ttname"><a href="group__mrf_common.html#gabb1acce6b2bea3fdb69992bf9af6e249">CONTROL_POSTDIV_SHIFT</a></div><div class="ttdeci">#define CONTROL_POSTDIV_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00154">mrfFracSynth.c:154</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga90fd6e42e0570a89df2d2395999befd7"><div class="ttname"><a href="group__mrf_common.html#ga90fd6e42e0570a89df2d2395999befd7">CONTROL_P_MASK</a></div><div class="ttdeci">#define CONTROL_P_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00169">mrfFracSynth.c:169</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga6af78dc3b0b89a75db6f2d59ab9589ff"><div class="ttname"><a href="group__mrf_common.html#ga6af78dc3b0b89a75db6f2d59ab9589ff">MAX_CORRECTION_RATIO</a></div><div class="ttdeci">#define MAX_CORRECTION_RATIO</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00116">mrfFracSynth.c:116</a></div></div>
<div class="ttc" id="debug_print_8h_html_a1eb67675f15a97117ed07fd84dba1584"><div class="ttname"><a href="debug_print_8h.html#a1eb67675f15a97117ed07fd84dba1584">DP_ERROR</a></div><div class="ttdeci">#define DP_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="debug_print_8h_source.html#l00090">debugPrint.h:90</a></div></div>
<div class="ttc" id="debug_print_8h_html_af46840b7d1e9fc3add9e7234d8ba5966"><div class="ttname"><a href="debug_print_8h.html#af46840b7d1e9fc3add9e7234d8ba5966">DP_FATAL</a></div><div class="ttdeci">#define DP_FATAL</div><div class="ttdef"><b>Definition:</b> <a href="debug_print_8h_source.html#l00089">debugPrint.h:89</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga32482de274074ad01b9ad07b5a77e6e2"><div class="ttname"><a href="group__mrf_common.html#ga32482de274074ad01b9ad07b5a77e6e2">MAX_VCO_FREQ</a></div><div class="ttdeci">#define MAX_VCO_FREQ</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00117">mrfFracSynth.c:117</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga117a878f86422dd7e98fbeb5958592d3"><div class="ttname"><a href="group__mrf_common.html#ga117a878f86422dd7e98fbeb5958592d3">CONTROL_MFG_MASK</a></div><div class="ttdeci">#define CONTROL_MFG_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00168">mrfFracSynth.c:168</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga9e59d92df51ad3f1edeb63822c2b4dfc"><div class="ttname"><a href="group__mrf_common.html#ga9e59d92df51ad3f1edeb63822c2b4dfc">CONTROL_PREAMBLE_SHIFT</a></div><div class="ttdeci">#define CONTROL_PREAMBLE_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00159">mrfFracSynth.c:159</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga80f7bbc9ef9ca7e45e6f2c050528af6b"><div class="ttname"><a href="group__mrf_common.html#ga80f7bbc9ef9ca7e45e6f2c050528af6b">CONTROL_MFG_SHIFT</a></div><div class="ttdeci">#define CONTROL_MFG_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00155">mrfFracSynth.c:155</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga194fca1519e1b595ac435efc2139cbc6"><div class="ttname"><a href="group__mrf_common.html#ga194fca1519e1b595ac435efc2139cbc6">CONTROL_QPM1_MASK</a></div><div class="ttdeci">#define CONTROL_QPM1_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00170">mrfFracSynth.c:170</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga241008895c5b58e27fbb669623ab28ce"><div class="ttname"><a href="group__mrf_common.html#ga241008895c5b58e27fbb669623ab28ce">NUM_CORRECTION_VALS</a></div><div class="ttdeci">#define NUM_CORRECTION_VALS</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00125">mrfFracSynth.c:125</a></div></div>
<div class="ttc" id="debug_print_8h_html_afeb648eb8d2d3c3754f00a0abd605320"><div class="ttname"><a href="debug_print_8h.html#afeb648eb8d2d3c3754f00a0abd605320">DP_DEBUG</a></div><div class="ttdeci">#define DP_DEBUG</div><div class="ttdef"><b>Definition:</b> <a href="debug_print_8h_source.html#l00093">debugPrint.h:93</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gae361c0306ceb8ef7701c8bff663c56e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae361c0306ceb8ef7701c8bff663c56e3">&#9670;&nbsp;</a></span>FracSynthControlWord()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">epicsShareExtern epicsUInt32 FracSynthControlWord </td>
          <td>(</td>
          <td class="paramtype">epicsFloat64&#160;</td>
          <td class="paramname"><em>DesiredFreq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">epicsFloat64&#160;</td>
          <td class="paramname"><em>ReferenceFreq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">epicsInt32&#160;</td>
          <td class="paramname"><em>debugFlag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">epicsFloat64 *&#160;</td>
          <td class="paramname"><em>Error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Description:</dt><dd></dd></dl>
<p>This routine will take a desired output frequency (expressed in MegaHertz)and a reference frequency (also expressed in MegaHertz) and create a control word for the Micrel SY877391L Fractional-N Synthesizer chip that will produce an output frequency as close as possible to the desired frequency. The routine also returns an error value (expressed in parts-per-million) between the actual output frequency and the desired output frequency.</p>
<dl class="section user"><dt>Function:</dt><dd></dd></dl>
<p>A complete description of how the Micrel SY87739L chip works is way beyond the scope of a function header comment. The reader who wants a complete understanding of what this routine is doing should refer to the Micrel SY87739L product description sheet available at: www.micrel.com</p>
<p>A brief description of the chip programming is useful, however, and is provided here:</p>
<p>The output frequency is described by the following formulae:</p>
<p>F(out) = F(vco) / PostDiv</p>
<p>where F(vco) is the frequency generated by a voltage-controlled oscillator, and PostDiv is a frequency divider value between 1 and 60 (not inclusive). The PostDiv value must be chosen so that the VCO frequency is within its operating range of 540 - 729 MHz. The VCO frequency is given by:</p>
<p>F(vco) = C * F(frac) * F(ref)</p>
<p>where C is a "Correction Factor" (also referred to as the "wrapper correction" in the documentation0 expressed as (N/M) where N and M are from the set {14, 15, 16, 17, 18, 31, 32}. Not all combinations, however, are legal. F(frac) is the fractional frequency produced by a fractional-N P/P-1 divider circuit. F(ref) is the input reference frequency to the Micrel chip. Typically it is 27 MHz, although in the MRF timing boards it is 24 MHz. The fractional frequency is basically a multiplier for the reference frequency. It is expressed as a rational number with a divisor less than 32 and is given by:</p>
<p>F(frac) = P - (Q(p-1) / (Q(p) + Q(p-1)))</p>
<p>where P is the integer part of the fractional frequency, Q(p) is the number of clock periods where the reference clock is divided by P and Q(p-1) is the number of clock periods where the reference clock is divided by P-1. A hardware implementation of Bresenham's algorithm is used to evenly space out the P and P-1 divisions. Beyond this, you'll have to read the manual for further details.</p>
<p>The routine works by doing an exhaustive search (with some optimizations) of the parameter space {C, Q(p), Q(p-1), PostDiv}. P is predetermined by F(out) and PostDiv, so it does not need to be searched. The Q(p), Q(p-1) search is accomplished by searching all the numerators for the denominator (Q(p) + Q(p-1)) that produce a fraction less than 1. Although an exhaustive search is not the most efficient way to optimize a 4-parameter space, it turns out that the dimensions of each parameter are not that big. PostDiv only has 31 unique values, and we only search the values that produce a valid F(vco). When you rule out duplications and illegal combinations it turns out that C only has 22 valid values, and if you arrange them in ascending order, you only have to search until the error value stops decreasing. For Q(p) and Q(p-1), we only have to search 31 denominators and for each denominator we only have to search n-1 numerators. This gives us n(n+1)/2, or 465 (for n=30) possible numerator/denominator pairs to search, although we stop immediately if we find a denominator that exactly divides the desired fractional frequency.</p>
<p>If we search 22 correction factors for each numerator/denominator pair, and we repeat the process for each of 31 possible PostDiv values, we get a worst case number of 317,130 possible combinations. In practice, the VCO frequency limitations (between 540 and 729 Megahertz) will usually eliminate most of the 31 possible PostDiv values. Given the other optimizations mentioned above, the worst case number is a pretty pathological example. In most cases the number of combinations actually searched will be far less than that.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">DesiredFreq</td><td>= (input) Desired output frequency in MegaHertz. </td></tr>
    <tr><td class="paramname">ReferenceFreq</td><td>= (input) SY87739L input reference frequency in MegaHertz. </td></tr>
    <tr><td class="paramname">debugFlag</td><td>= (input) Flag for debug output. If the value is 4 (DP_INFO) or higher, the routine will print the value of the control word and the frequency actually produced. </td></tr>
    <tr><td class="paramname">Error</td><td>= (output) Error between the actual output frequency and the desired output frequency. Expressed in parts-per-million.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Implicit Inputs:</dt><dd><em>CorrectionList</em> = (<a class="el" href="struct_correction_struct.html">CorrectionStruct</a>) List of all valid correction factors and their control-word encodings.<br />
 <em>PostDivideList</em> = (<a class="el" href="struct_post_divide_struct.html">PostDivideStruct</a>) List of valid post-divide values and their control-word encodings.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Returns the SY87739L Control Word for the desired frequency. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00552">552</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;{</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">    *  Local Variables</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="struct_frac_synth_components.html">FracSynthComponents</a>  Best;                <span class="comment">/* Best overall parameters seen so far              */</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="struct_frac_synth_components.html">FracSynthComponents</a>  BestFracFreq;        <span class="comment">/* Best fractional frequency parameters seen so far */</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    epicsUInt32          ControlWord;         <span class="comment">/* Computed control word value                      */</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    epicsFloat64         CorrectionErr;       <span class="comment">/* Error value for current correction factor        */</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    epicsFloat64         CorrectionFreq;      <span class="comment">/* Frequency after applying the correction factor   */</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    epicsInt32           CorrectionIndex;     <span class="comment">/* Index to correction factor list                  */</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    epicsFloat64         d;                   <span class="comment">/* FP representation of the current denominator     */</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    epicsFloat64         EffectiveFreq = 0.0; <span class="comment">/* Effective output frequency                       */</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    epicsFloat64         FracFreqErr;         <span class="comment">/* Best fractional frequency error seen so far      */</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    epicsFloat64         FractionalFreq;      <span class="comment">/* Desired fractional frequency                     */</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    epicsFloat64         FreqErr;             <span class="comment">/* Error value for the desired frequency            */</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    epicsInt32           i, j, k, n;          <span class="comment">/* Loop indicies                                    */</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    epicsInt32           Numerator = 1;       <span class="comment">/* Best numerator found for current denominator     */</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    epicsFloat64         OldCorrectionErr;    <span class="comment">/* Error value for previous correction factor       */</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    epicsInt32           p;                   <span class="comment">/* Integer part of fractional frequency             */</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    epicsInt32           p1;                  <span class="comment">/* Numerator of fractional frequency ratio          */</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    epicsInt32           Qp;                  <span class="comment">/* Number of &quot;P&quot; pulses in the frac. div. circuit   */</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    epicsInt32           Qpm1;                <span class="comment">/* Number of &quot;P-1&quot; pulses in the frac. div. circuit */</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    epicsFloat64         TestFreq;            <span class="comment">/* Fractional frequency to try in correction loop   */</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">    * Initialize the &quot;Best Fractional Frequency So Far&quot; parameters</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    BestFracFreq.<a class="code" href="struct_frac_synth_components.html#a695983b5a06bad830c0012b808d2de24">Error</a>           = <a class="code" href="group__mrf_common.html#ga7c213cc89d01ec9cdbaa3356698a86ce">MAX_ERROR</a>;   <span class="comment">/* Deviation from desired output frequency        */</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    BestFracFreq.<a class="code" href="struct_frac_synth_components.html#a57069c06f13858f7ee4c6d39988d6de8">EffectiveFreq</a>   = 0.0;         <span class="comment">/* Actual frequency generated by these components */</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    BestFracFreq.<a class="code" href="struct_frac_synth_components.html#a0b7f2c446b60d3be99d545da8ce127dd">PostDivIndex</a>    = 0;           <span class="comment">/* Index into post-divider table                  */</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    BestFracFreq.<a class="code" href="struct_frac_synth_components.html#a227c260e3cc90ec7a855645bb375bed9">CorrectionIndex</a> = 0;           <span class="comment">/* Index into correction factor table             */</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    BestFracFreq.<a class="code" href="struct_frac_synth_components.html#a6171ca554024189b0bf57a55d45ca88e">P</a>               = 0;           <span class="comment">/* Integer part of fractional frequency           */</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    BestFracFreq.<a class="code" href="struct_frac_synth_components.html#acfb46792066dfc3a61283fbe6091ee5f">Qp</a>              = 1;           <span class="comment">/* Value of Q(p) term of fractional frequency     */</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    BestFracFreq.<a class="code" href="struct_frac_synth_components.html#aa5f82a2db7f90fb9dd50793626e85ed3">Qpm1</a>            = 1;           <span class="comment">/* Value of Q(p-1) term of fractional frequency   */</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    Best = BestFracFreq;                        <span class="comment">/* Best overall parameters                        */</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">    * Post-Divider Loop:</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">    *---------------------</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">    *  Check all post-divider values that would put the VCO frequency within</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">    *  the allowable range (540 - 729 MHz).</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    Best.<a class="code" href="struct_frac_synth_components.html#a695983b5a06bad830c0012b808d2de24">Error</a> = <a class="code" href="group__mrf_common.html#ga7c213cc89d01ec9cdbaa3356698a86ce">MAX_ERROR</a>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">for</span> (i=0;  i &lt; <a class="code" href="group__mrf_common.html#ga67676a1360dc48867462b00234056f99">NUM_POST_DIVIDES</a>;  i++) {</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        epicsFloat64 PostDivide = PostDivideList[i].<a class="code" href="struct_post_divide_struct.html#a0d36a5186c9644354657cfbaee10fbcf">Divisor</a>;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;       <span class="comment">/*---------------------</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="comment">        * Compute the VCO frequency and make sure it is within the allowable range.</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        epicsFloat64 VcoFreq = DesiredFreq * PostDivide;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">if</span> (VcoFreq &gt;= <a class="code" href="group__mrf_common.html#ga32482de274074ad01b9ad07b5a77e6e2">MAX_VCO_FREQ</a>)</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordflow">if</span> (VcoFreq &gt;= <a class="code" href="group__mrf_common.html#ga4028643367a81118579bb9ff00dbb317">MIN_VCO_FREQ</a>) {</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;           <span class="comment">/*---------------------</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="comment">            * We have a VCO frequency inside the allowable range.</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="comment">            * Now compute the desired fractional frequency.</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="comment">            *</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="comment">            * The desired fractional frequency is derived by dividing the VCO frequency by the</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment">            * reference frequency.  The actual fractional-N frequency is created by a fractional-N</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">            * P/P-1 divider which attempts to represent the desired fractional frequency as a</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">            * rational fraction (with a divisor less than 32) of the reference frequency.</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment">            *</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment">            * Note that the actual fractional-N frequency may not be exactly identical to the</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment">            * desired fractional frequency.</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">            */</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            FractionalFreq = VcoFreq / ReferenceFreq;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            BestFracFreq.<a class="code" href="struct_frac_synth_components.html#a695983b5a06bad830c0012b808d2de24">Error</a> = <a class="code" href="group__mrf_common.html#ga7c213cc89d01ec9cdbaa3356698a86ce">MAX_ERROR</a>;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;           <span class="comment">/*---------------------</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment">            * Divisor Loop:</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">            *--------------------- </span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment">            *  Search for a divisor that will produce the closest fractional-N P/P-1 frequency to</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">            *  the desired fractional frequency.  If we are lucky, we will find a number that</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment">            *  exactly divides the desired fractional frequency and we can stop the search here.</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">            *  If not, we will have to try different numerator and correction factor combinations</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment">            *  in order to find the closest fit.</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">            */</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="keywordflow">for</span> (j=1;  j &lt;= <a class="code" href="group__mrf_common.html#gabef9b0318c864d32d39586183a047d94">MAX_FRAC_DIVISOR</a>;  j++) {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                d = j;                  <span class="comment">/* Floating point representation of denominator  */</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                CorrectionIndex = 0;    <span class="comment">/* No correction factor                          */</span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;               <span class="comment">/*---------------------</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">                * Compute the integer and fractional parts of the fractional-N frequency</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">                */</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                p1 = (epicsInt32)(FractionalFreq * j);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                p = (p1 / j) + 1;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                Qpm1 = j - (p1 % j);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                Qp = j - Qpm1;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;               <span class="comment">/*---------------------</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment">                * Compute the actual frequency generated by the fractional-N P/P-1 divider</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment">                * for these values.  Also compute the error between the actual fractional</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">                * frequency and the desired fractional frequency.</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">                */</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                EffectiveFreq = (double)p - ((<span class="keywordtype">double</span>)Qpm1 / (double)(Qp + Qpm1));</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                FracFreqErr = fabs (FractionalFreq - EffectiveFreq);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;               <span class="comment">/*---------------------</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">                * If the current divisor does not exactly divide the desired fractional frequency,</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">                * search for a numerator and correction-factor pair that will come closest to</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">                * generating the desired fractional frequency.</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">                */</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                <span class="keywordflow">if</span> (FracFreqErr &gt;= <a class="code" href="group__mrf_common.html#ga0d288a400b18620bab417c0911c78811">ZERO_THRESHOLD</a>) {</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                    FracFreqErr = <a class="code" href="group__mrf_common.html#ga7c213cc89d01ec9cdbaa3356698a86ce">MAX_ERROR</a>;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment">                    * Numerator Loop:</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment">                    *---------------------</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment">                    *  Search for the numerator/correction-factor pair with the lowest error.</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">                    */</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                    <span class="keywordflow">for</span> (n = 1;  n &lt;= j;  n++) {</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                        TestFreq = (double)p - ((<span class="keywordtype">double</span>)n / d);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                        OldCorrectionErr = <a class="code" href="group__mrf_common.html#ga7c213cc89d01ec9cdbaa3356698a86ce">MAX_ERROR</a>;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                       <span class="comment">/*---------------------</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">                        * Correction Factor Loop:</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">                        *---------------------</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">                        *  Search for the correction factor that produces the lowest error</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">                        *  with the current numerator/denominator pair.  Note that since the</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">                        *  correction factor list is arranged in ascending order, we can</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">                        *  stop the search as soon as the error value stops decreasing.</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">                        */</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                        <span class="keywordflow">for</span> (k = 1;  k &lt; <a class="code" href="group__mrf_common.html#ga179cb66a9388422a1abb1514ab4dd468">NUM_CORRECTIONS</a>;  k++) {</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                            CorrectionFreq = CorrectionList[k].<a class="code" href="struct_correction_struct.html#aedbc23c0d3395429954c76fbfe4b59f3">Ratio</a> * TestFreq;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                            CorrectionErr = fabs (FractionalFreq - CorrectionFreq);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                            <span class="keywordflow">if</span> (CorrectionErr &gt; OldCorrectionErr) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                            OldCorrectionErr = CorrectionErr;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                           <span class="comment">/*---------------------</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="comment">                            * If we found a numerator/correction-factor pair with a lower error</span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">                            * than the previous error for this denominator, replace the previous</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">                            * values.</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="comment">                            */</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;                            <span class="keywordflow">if</span> (CorrectionErr &lt; FracFreqErr) {</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;                                EffectiveFreq = CorrectionFreq;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;                                FracFreqErr = CorrectionErr;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                                Numerator = n;</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                                CorrectionIndex = k;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                            }<span class="comment">/*end if we found a better numerator/correction pair*/</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                        }<span class="comment">/*end correction factor loop*/</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                    }<span class="comment">/*end numerator loop*/</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">                    * At this point, we now have the best numerator/correction-factor pair</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment">                    * for the current denominator.  Recompute the Q(p) and Q(p-1) values</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">                    * based on the new numerator value.</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">                    *</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">                    * It could happen that the numerator/denominator/correction set we found</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">                    * produces the desired fractional frequency exactly (FracFreqErr == 0).</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">                    * If this occurs, we will set FracFreqErr to the zero-threshold value so that</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">                    * the algorithm gives preference to solutions that do not require a correction</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">                    * factor.</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">                    */</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                    Qpm1 = Numerator;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;                    Qp = j - Numerator;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                    <span class="keywordflow">if</span> (FracFreqErr &lt; <a class="code" href="group__mrf_common.html#ga0d288a400b18620bab417c0911c78811">ZERO_THRESHOLD</a>)</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                        FracFreqErr = <a class="code" href="group__mrf_common.html#ga0d288a400b18620bab417c0911c78811">ZERO_THRESHOLD</a>;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                }<span class="comment">/*end denominator does not exactly divide the desired fractional frequency*/</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;               <span class="comment">/*---------------------</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">                * Store the parameters for the numerator/correction pair that produces the lowest</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="comment">                * fractional frequency error for this denominator.  If it turns out that the</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="comment">                * denominator exactly divides the desired fractional frequency (FracFreqErr == 0),</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">                * exit the denominator loop now.</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">                */</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;                <span class="keywordflow">if</span> (FracFreqErr &lt; BestFracFreq.<a class="code" href="struct_frac_synth_components.html#a695983b5a06bad830c0012b808d2de24">Error</a>) {</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                    BestFracFreq.<a class="code" href="struct_frac_synth_components.html#a695983b5a06bad830c0012b808d2de24">Error</a> = FracFreqErr;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                    BestFracFreq.<a class="code" href="struct_frac_synth_components.html#a57069c06f13858f7ee4c6d39988d6de8">EffectiveFreq</a> = EffectiveFreq;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                    BestFracFreq.<a class="code" href="struct_frac_synth_components.html#a6171ca554024189b0bf57a55d45ca88e">P</a> = p;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                    BestFracFreq.<a class="code" href="struct_frac_synth_components.html#acfb46792066dfc3a61283fbe6091ee5f">Qp</a> = Qp;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                    BestFracFreq.<a class="code" href="struct_frac_synth_components.html#aa5f82a2db7f90fb9dd50793626e85ed3">Qpm1</a> = Qpm1;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                    BestFracFreq.<a class="code" href="struct_frac_synth_components.html#a227c260e3cc90ec7a855645bb375bed9">CorrectionIndex</a> = CorrectionIndex;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                    <span class="keywordflow">if</span> (FracFreqErr &lt; <a class="code" href="group__mrf_common.html#ga0d288a400b18620bab417c0911c78811">ZERO_THRESHOLD</a>) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                }<span class="comment">/*end if fractional frequency is best so far*/</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            }<span class="comment">/*end denominator loop*/</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;           <span class="comment">/*---------------------</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment">            * Adjust the fractional frequency error for the current post divider.</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">            * If the adjusted frequency error is less than the current best, make</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">            * this the current best.  If the new parameters produce an exact match</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">            * (FreqErr == 0), exit the post-divider loop now.</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">            */</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;            FreqErr = (BestFracFreq.<a class="code" href="struct_frac_synth_components.html#a695983b5a06bad830c0012b808d2de24">Error</a> * ReferenceFreq) / PostDivide;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="keywordflow">if</span> (FreqErr &lt; Best.<a class="code" href="struct_frac_synth_components.html#a695983b5a06bad830c0012b808d2de24">Error</a>) {</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                Best = BestFracFreq;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                Best.<a class="code" href="struct_frac_synth_components.html#a0b7f2c446b60d3be99d545da8ce127dd">PostDivIndex</a> = i;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                Best.<a class="code" href="struct_frac_synth_components.html#a695983b5a06bad830c0012b808d2de24">Error</a> = FreqErr;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                Best.<a class="code" href="struct_frac_synth_components.html#a57069c06f13858f7ee4c6d39988d6de8">EffectiveFreq</a> = (BestFracFreq.<a class="code" href="struct_frac_synth_components.html#a57069c06f13858f7ee4c6d39988d6de8">EffectiveFreq</a> * ReferenceFreq) / PostDivide;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                <span class="keywordflow">if</span> (FreqErr &lt; <a class="code" href="group__mrf_common.html#ga0d288a400b18620bab417c0911c78811">ZERO_THRESHOLD</a>) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            }<span class="comment">/*end if this post-divide solution is the best so far*/</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        }<span class="comment">/*end if VCO frequency is within range*/</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    }<span class="comment">/*end for each post divider*/</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="comment">    * Abort if we could not come up with a set of parameters that would produce the</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="comment">    * desired frequency.</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__mrf_common.html#ga7c213cc89d01ec9cdbaa3356698a86ce">MAX_ERROR</a> == Best.<a class="code" href="struct_frac_synth_components.html#a695983b5a06bad830c0012b808d2de24">Error</a>) <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">    * Construct the control word from the parameters found in the search above.</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    CorrectionIndex = Best.<a class="code" href="struct_frac_synth_components.html#a227c260e3cc90ec7a855645bb375bed9">CorrectionIndex</a>;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    ControlWord =</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      ((CorrectionList[CorrectionIndex].<a class="code" href="struct_correction_struct.html#a597b42ecf7e020b6705cdc7b1f009fc7">mDiv</a>   &lt;&lt; <a class="code" href="group__mrf_common.html#ga10b8efb38f7365a86997b787e987a8f8">CONTROL_MDIV_SHIFT</a>)    &amp; <a class="code" href="group__mrf_common.html#gad90524aaa3787cca45eafcb147cb4346">CONTROL_MDIV_MASK</a>)      |</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      ((CorrectionList[CorrectionIndex].<a class="code" href="struct_correction_struct.html#a38b50103214b679299dd6a069b6a4284">nDiv</a>   &lt;&lt; <a class="code" href="group__mrf_common.html#ga8a6eeeaab8ad2d1f6c4f9faeab9c38d5">CONTROL_NDIV_SHIFT</a>)    &amp; <a class="code" href="group__mrf_common.html#gae735d7fd3e8f4981dbb3bd337df282f5">CONTROL_NDIV_MASK</a>)      |</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      ((PostDivideList[Best.<a class="code" href="struct_frac_synth_components.html#a0b7f2c446b60d3be99d545da8ce127dd">PostDivIndex</a>].<a class="code" href="struct_post_divide_struct.html#ae829d659292189ab32db9d3fe576fcd8">Code</a> &lt;&lt; <a class="code" href="group__mrf_common.html#gabb1acce6b2bea3fdb69992bf9af6e249">CONTROL_POSTDIV_SHIFT</a>) &amp; <a class="code" href="group__mrf_common.html#ga2353751d1a178b2f08a5444c176ba82b">CONTROL_POSTDIV_MASK</a>)   |</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      (((Best.<a class="code" href="struct_frac_synth_components.html#a6171ca554024189b0bf57a55d45ca88e">P</a> - 1)                           &lt;&lt; <a class="code" href="group__mrf_common.html#gaecc281ac9a85b842baef7f0e3d9ad5fe">CONTROL_P_SHIFT</a>)       &amp; <a class="code" href="group__mrf_common.html#ga90fd6e42e0570a89df2d2395999befd7">CONTROL_P_MASK</a>)         |</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      ((Best.<a class="code" href="struct_frac_synth_components.html#aa5f82a2db7f90fb9dd50793626e85ed3">Qpm1</a>                              &lt;&lt; <a class="code" href="group__mrf_common.html#ga49ab24588b7ce39f2d8f6bdd89898324">CONTROL_QPM1_SHIFT</a>)    &amp; <a class="code" href="group__mrf_common.html#ga194fca1519e1b595ac435efc2139cbc6">CONTROL_QPM1_MASK</a>)      |</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      ((Best.<a class="code" href="struct_frac_synth_components.html#acfb46792066dfc3a61283fbe6091ee5f">Qp</a>                                &lt;&lt; <a class="code" href="group__mrf_common.html#ga5f146a143e408be0fc1f3cfe933aada2">CONTROL_QP_SHIFT</a>)      &amp; <a class="code" href="group__mrf_common.html#gaced1549e7d5fa7b5e09eda9aea9f51da">CONTROL_QP_MASK</a>);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">    * Compute the frequency that will actually be generated from these parameters.</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    EffectiveFreq = CorrectionList[CorrectionIndex].<a class="code" href="struct_correction_struct.html#aedbc23c0d3395429954c76fbfe4b59f3">Ratio</a> * ReferenceFreq *</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                     ((double)Best.<a class="code" href="struct_frac_synth_components.html#a6171ca554024189b0bf57a55d45ca88e">P</a> - ((<span class="keywordtype">double</span>)Best.<a class="code" href="struct_frac_synth_components.html#aa5f82a2db7f90fb9dd50793626e85ed3">Qpm1</a> /(double)(Best.<a class="code" href="struct_frac_synth_components.html#acfb46792066dfc3a61283fbe6091ee5f">Qp</a> + Best.<a class="code" href="struct_frac_synth_components.html#aa5f82a2db7f90fb9dd50793626e85ed3">Qpm1</a>))) /</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                       PostDivideList[Best.<a class="code" href="struct_frac_synth_components.html#a0b7f2c446b60d3be99d545da8ce127dd">PostDivIndex</a>].<a class="code" href="struct_post_divide_struct.html#a0d36a5186c9644354657cfbaee10fbcf">Divisor</a>;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">    * Return the error (in parts-per-million) between the desired and actual frequencies.</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    *Error = 1.e6 * (EffectiveFreq - DesiredFreq) / DesiredFreq;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">    * Output debug information about the results of this call</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a9452553981beadb03ffa4e4a4b37888a">DP_INFO</a>, debugFlag,</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;               (<span class="stringliteral">&quot;Desired Frequency = %f,  Control Word = %08X\n&quot;</span>, DesiredFreq, ControlWord));</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#a9452553981beadb03ffa4e4a4b37888a">DP_INFO</a>, debugFlag,</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;               (<span class="stringliteral">&quot;Effective Frequency = %15.12f, Error = %5.3f ppm\n&quot;</span>, EffectiveFreq, *Error));</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">    * Return the computed control word.</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="keywordflow">return</span> ControlWord;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;}<span class="comment">/*end FracSynthControlWord()*/</span></div><div class="ttc" id="group__mrf_common_html_ga5f146a143e408be0fc1f3cfe933aada2"><div class="ttname"><a href="group__mrf_common.html#ga5f146a143e408be0fc1f3cfe933aada2">CONTROL_QP_SHIFT</a></div><div class="ttdeci">#define CONTROL_QP_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00158">mrfFracSynth.c:158</a></div></div>
<div class="ttc" id="debug_print_8h_html_acb21e1590588b784857197e3e416673a"><div class="ttname"><a href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a></div><div class="ttdeci">#define DEBUGPRINT(interest, globalFlag, args)</div><div class="ttdef"><b>Definition:</b> <a href="debug_print_8h_source.html#l00102">debugPrint.h:102</a></div></div>
<div class="ttc" id="struct_correction_struct_html_a38b50103214b679299dd6a069b6a4284"><div class="ttname"><a href="struct_correction_struct.html#a38b50103214b679299dd6a069b6a4284">CorrectionStruct::nDiv</a></div><div class="ttdeci">epicsUInt16 nDiv</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00204">mrfFracSynth.c:204</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga8a6eeeaab8ad2d1f6c4f9faeab9c38d5"><div class="ttname"><a href="group__mrf_common.html#ga8a6eeeaab8ad2d1f6c4f9faeab9c38d5">CONTROL_NDIV_SHIFT</a></div><div class="ttdeci">#define CONTROL_NDIV_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00153">mrfFracSynth.c:153</a></div></div>
<div class="ttc" id="group__mrf_common_html_gaecc281ac9a85b842baef7f0e3d9ad5fe"><div class="ttname"><a href="group__mrf_common.html#gaecc281ac9a85b842baef7f0e3d9ad5fe">CONTROL_P_SHIFT</a></div><div class="ttdeci">#define CONTROL_P_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00156">mrfFracSynth.c:156</a></div></div>
<div class="ttc" id="struct_correction_struct_html_aedbc23c0d3395429954c76fbfe4b59f3"><div class="ttname"><a href="struct_correction_struct.html#aedbc23c0d3395429954c76fbfe4b59f3">CorrectionStruct::Ratio</a></div><div class="ttdeci">epicsFloat64 Ratio</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00203">mrfFracSynth.c:203</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga49ab24588b7ce39f2d8f6bdd89898324"><div class="ttname"><a href="group__mrf_common.html#ga49ab24588b7ce39f2d8f6bdd89898324">CONTROL_QPM1_SHIFT</a></div><div class="ttdeci">#define CONTROL_QPM1_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00157">mrfFracSynth.c:157</a></div></div>
<div class="ttc" id="struct_frac_synth_components_html_aa5f82a2db7f90fb9dd50793626e85ed3"><div class="ttname"><a href="struct_frac_synth_components.html#aa5f82a2db7f90fb9dd50793626e85ed3">FracSynthComponents::Qpm1</a></div><div class="ttdeci">epicsInt32 Qpm1</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00226">mrfFracSynth.c:226</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga179cb66a9388422a1abb1514ab4dd468"><div class="ttname"><a href="group__mrf_common.html#ga179cb66a9388422a1abb1514ab4dd468">NUM_CORRECTIONS</a></div><div class="ttdeci">#define NUM_CORRECTIONS</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00124">mrfFracSynth.c:124</a></div></div>
<div class="ttc" id="struct_frac_synth_components_html_a695983b5a06bad830c0012b808d2de24"><div class="ttname"><a href="struct_frac_synth_components.html#a695983b5a06bad830c0012b808d2de24">FracSynthComponents::Error</a></div><div class="ttdeci">epicsFloat64 Error</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00220">mrfFracSynth.c:220</a></div></div>
<div class="ttc" id="struct_frac_synth_components_html_a57069c06f13858f7ee4c6d39988d6de8"><div class="ttname"><a href="struct_frac_synth_components.html#a57069c06f13858f7ee4c6d39988d6de8">FracSynthComponents::EffectiveFreq</a></div><div class="ttdeci">epicsFloat64 EffectiveFreq</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00221">mrfFracSynth.c:221</a></div></div>
<div class="ttc" id="struct_frac_synth_components_html_a0b7f2c446b60d3be99d545da8ce127dd"><div class="ttname"><a href="struct_frac_synth_components.html#a0b7f2c446b60d3be99d545da8ce127dd">FracSynthComponents::PostDivIndex</a></div><div class="ttdeci">epicsInt32 PostDivIndex</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00222">mrfFracSynth.c:222</a></div></div>
<div class="ttc" id="debug_print_8h_html_a9452553981beadb03ffa4e4a4b37888a"><div class="ttname"><a href="debug_print_8h.html#a9452553981beadb03ffa4e4a4b37888a">DP_INFO</a></div><div class="ttdeci">#define DP_INFO</div><div class="ttdef"><b>Definition:</b> <a href="debug_print_8h_source.html#l00092">debugPrint.h:92</a></div></div>
<div class="ttc" id="struct_post_divide_struct_html_a0d36a5186c9644354657cfbaee10fbcf"><div class="ttname"><a href="struct_post_divide_struct.html#a0d36a5186c9644354657cfbaee10fbcf">PostDivideStruct::Divisor</a></div><div class="ttdeci">epicsFloat64 Divisor</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00195">mrfFracSynth.c:195</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga2353751d1a178b2f08a5444c176ba82b"><div class="ttname"><a href="group__mrf_common.html#ga2353751d1a178b2f08a5444c176ba82b">CONTROL_POSTDIV_MASK</a></div><div class="ttdeci">#define CONTROL_POSTDIV_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00167">mrfFracSynth.c:167</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga7c213cc89d01ec9cdbaa3356698a86ce"><div class="ttname"><a href="group__mrf_common.html#ga7c213cc89d01ec9cdbaa3356698a86ce">MAX_ERROR</a></div><div class="ttdeci">#define MAX_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00127">mrfFracSynth.c:127</a></div></div>
<div class="ttc" id="group__mrf_common_html_gabef9b0318c864d32d39586183a047d94"><div class="ttname"><a href="group__mrf_common.html#gabef9b0318c864d32d39586183a047d94">MAX_FRAC_DIVISOR</a></div><div class="ttdeci">#define MAX_FRAC_DIVISOR</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00120">mrfFracSynth.c:120</a></div></div>
<div class="ttc" id="group__mrf_common_html_gae735d7fd3e8f4981dbb3bd337df282f5"><div class="ttname"><a href="group__mrf_common.html#gae735d7fd3e8f4981dbb3bd337df282f5">CONTROL_NDIV_MASK</a></div><div class="ttdeci">#define CONTROL_NDIV_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00166">mrfFracSynth.c:166</a></div></div>
<div class="ttc" id="group__mrf_common_html_gaced1549e7d5fa7b5e09eda9aea9f51da"><div class="ttname"><a href="group__mrf_common.html#gaced1549e7d5fa7b5e09eda9aea9f51da">CONTROL_QP_MASK</a></div><div class="ttdeci">#define CONTROL_QP_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00171">mrfFracSynth.c:171</a></div></div>
<div class="ttc" id="group__mrf_common_html_gad90524aaa3787cca45eafcb147cb4346"><div class="ttname"><a href="group__mrf_common.html#gad90524aaa3787cca45eafcb147cb4346">CONTROL_MDIV_MASK</a></div><div class="ttdeci">#define CONTROL_MDIV_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00165">mrfFracSynth.c:165</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga10b8efb38f7365a86997b787e987a8f8"><div class="ttname"><a href="group__mrf_common.html#ga10b8efb38f7365a86997b787e987a8f8">CONTROL_MDIV_SHIFT</a></div><div class="ttdeci">#define CONTROL_MDIV_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00152">mrfFracSynth.c:152</a></div></div>
<div class="ttc" id="struct_frac_synth_components_html_acfb46792066dfc3a61283fbe6091ee5f"><div class="ttname"><a href="struct_frac_synth_components.html#acfb46792066dfc3a61283fbe6091ee5f">FracSynthComponents::Qp</a></div><div class="ttdeci">epicsInt32 Qp</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00225">mrfFracSynth.c:225</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga4028643367a81118579bb9ff00dbb317"><div class="ttname"><a href="group__mrf_common.html#ga4028643367a81118579bb9ff00dbb317">MIN_VCO_FREQ</a></div><div class="ttdeci">#define MIN_VCO_FREQ</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00118">mrfFracSynth.c:118</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga0d288a400b18620bab417c0911c78811"><div class="ttname"><a href="group__mrf_common.html#ga0d288a400b18620bab417c0911c78811">ZERO_THRESHOLD</a></div><div class="ttdeci">#define ZERO_THRESHOLD</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00128">mrfFracSynth.c:128</a></div></div>
<div class="ttc" id="group__mrf_common_html_gabb1acce6b2bea3fdb69992bf9af6e249"><div class="ttname"><a href="group__mrf_common.html#gabb1acce6b2bea3fdb69992bf9af6e249">CONTROL_POSTDIV_SHIFT</a></div><div class="ttdeci">#define CONTROL_POSTDIV_SHIFT</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00154">mrfFracSynth.c:154</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga90fd6e42e0570a89df2d2395999befd7"><div class="ttname"><a href="group__mrf_common.html#ga90fd6e42e0570a89df2d2395999befd7">CONTROL_P_MASK</a></div><div class="ttdeci">#define CONTROL_P_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00169">mrfFracSynth.c:169</a></div></div>
<div class="ttc" id="struct_frac_synth_components_html_a6171ca554024189b0bf57a55d45ca88e"><div class="ttname"><a href="struct_frac_synth_components.html#a6171ca554024189b0bf57a55d45ca88e">FracSynthComponents::P</a></div><div class="ttdeci">epicsInt32 P</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00224">mrfFracSynth.c:224</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga32482de274074ad01b9ad07b5a77e6e2"><div class="ttname"><a href="group__mrf_common.html#ga32482de274074ad01b9ad07b5a77e6e2">MAX_VCO_FREQ</a></div><div class="ttdeci">#define MAX_VCO_FREQ</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00117">mrfFracSynth.c:117</a></div></div>
<div class="ttc" id="struct_post_divide_struct_html_ae829d659292189ab32db9d3fe576fcd8"><div class="ttname"><a href="struct_post_divide_struct.html#ae829d659292189ab32db9d3fe576fcd8">PostDivideStruct::Code</a></div><div class="ttdeci">epicsUInt32 Code</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00196">mrfFracSynth.c:196</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga67676a1360dc48867462b00234056f99"><div class="ttname"><a href="group__mrf_common.html#ga67676a1360dc48867462b00234056f99">NUM_POST_DIVIDES</a></div><div class="ttdeci">#define NUM_POST_DIVIDES</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00122">mrfFracSynth.c:122</a></div></div>
<div class="ttc" id="struct_frac_synth_components_html"><div class="ttname"><a href="struct_frac_synth_components.html">FracSynthComponents</a></div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00219">mrfFracSynth.c:219</a></div></div>
<div class="ttc" id="struct_correction_struct_html_a597b42ecf7e020b6705cdc7b1f009fc7"><div class="ttname"><a href="struct_correction_struct.html#a597b42ecf7e020b6705cdc7b1f009fc7">CorrectionStruct::mDiv</a></div><div class="ttdeci">epicsUInt16 mDiv</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00205">mrfFracSynth.c:205</a></div></div>
<div class="ttc" id="struct_frac_synth_components_html_a227c260e3cc90ec7a855645bb375bed9"><div class="ttname"><a href="struct_frac_synth_components.html#a227c260e3cc90ec7a855645bb375bed9">FracSynthComponents::CorrectionIndex</a></div><div class="ttdeci">epicsInt32 CorrectionIndex</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00223">mrfFracSynth.c:223</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga194fca1519e1b595ac435efc2139cbc6"><div class="ttname"><a href="group__mrf_common.html#ga194fca1519e1b595ac435efc2139cbc6">CONTROL_QPM1_MASK</a></div><div class="ttdeci">#define CONTROL_QPM1_MASK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00170">mrfFracSynth.c:170</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="gae10824b00b8a005d97c74a11cdc9922b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae10824b00b8a005d97c74a11cdc9922b">&#9670;&nbsp;</a></span>mrfSetEventClockSpeed()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">epicsShareExtern epicsStatus mrfSetEventClockSpeed </td>
          <td>(</td>
          <td class="paramtype">epicsFloat64&#160;</td>
          <td class="paramname"><em>InputClockSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">epicsUInt32&#160;</td>
          <td class="paramname"><em>InputControlWord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">epicsFloat64&#160;</td>
          <td class="paramname"><em>ReferenceFreq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">epicsFloat64 *&#160;</td>
          <td class="paramname"><em>OutputClockSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">epicsUInt32 *&#160;</td>
          <td class="paramname"><em>OutputControlWord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">epicsInt32&#160;</td>
          <td class="paramname"><em>PrintFlag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section user"><dt>Description:</dt><dd></dd></dl>
<p>This routine will determine the system's event clock speed (in Megahertz) and/or the value for the fractional synthesizer control word given at least one of these two values.</p>
<dl class="section user"><dt>Function:</dt><dd></dd></dl>
<p>If the InputClockSpeed parameter is specified (not zero), the routine will compute the value of the fractional synthesizer control word to produce that frequency.</p>
<p>If the InputControlWord parameter is specified (not zero), the routine will check the control word for programming errors and return the actual frequency (in Megahertz) produced by that control word.</p>
<p>If neither parameter is specified, the routine will output a default event clock frequency and a default control word.</p>
<p>If both parameters are specified, the routine will make sure the frequency generated by the control word is within 100 ppm of the desired clock speed.</p>
<p>If no errors are encountered, the routine will return both the final event clock speed and the fractional synthesizer control word. If errors are encountered, both output parameters will contain zero.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">InputClockSpeed</td><td>= (input) Desired event clock speed in Megahertz. 0.0 means no clock speed specified. </td></tr>
    <tr><td class="paramname">InputControlWord</td><td>= (input) Desired value for the fractional synthesizer control word. 0 means no control word specified. </td></tr>
    <tr><td class="paramname">ReferenceFreq</td><td>= (input) SY87739L input reference frequency in MegaHertz. </td></tr>
    <tr><td class="paramname">OutputClockSpeed</td><td>= (output) The input or computed value for the event clock speed </td></tr>
    <tr><td class="paramname">OutputControlWord</td><td>= (output) The input or computed value for the fractional synthesizer control word. </td></tr>
    <tr><td class="paramname">PrintFlag</td><td>= (input) Flag to control output messages. <a class="el" href="class_output.html">Output</a> levels correspond to the DEBUGPRINT output levels:<br />
 DP_NONE (0) = Only display errors that prevent us from returning the event clock speed and the control word.<br />
 DP_ERROR (2) = Display any programming errors detected in the control word.<br />
 DP_WARN (3) = Display warning messages such as the one warning that we are using the default event clock frequency.<br />
 DP_INFO (4) = Display the value of the computed control word, its actual output frequency, and the error (in ppm) between the desired and actual frequencies.<br />
 DP_DEBUG (5) = Display the actual values of the fields in the control word, along with the constituent parts of the output frequency (VCO frequency, correction term, reference freq.)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>OK if we were able to return both an event clock frequency and a fractional synthesizer control word.<br />
 ERROR if we could not. </dd></dl>

<p class="definition">Definition at line <a class="el" href="mrf_frac_synth_8c_source.html#l00365">365</a> of file <a class="el" href="mrf_frac_synth_8c_source.html">mrfFracSynth.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;{</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">    *  Local Variables</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    epicsFloat64   ActualClockSpeed;            <span class="comment">/* Actual frequency generated by the control word */</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    epicsFloat64   Error = 0.0;                 <span class="comment">/* Error (in ppm) between desired &amp; actual freq.  */</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">    * Zero the output clock speed and control word parameters just in case there is an error.</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    *OutputClockSpeed  = 0.0;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    *OutputControlWord = 0;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment">    * Compute the Fractional Synthesizer control word if one was not provided</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> (0 == InputControlWord) {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;       <span class="comment">/*---------------------</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">        * If a clock speed was not specified either, use the default clock speed.</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordflow">if</span> (0.0 == InputClockSpeed) {</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            InputClockSpeed = <a class="code" href="mrf_common_8h.html#af6962fd537fefce1778d02205c8562a5">MRF_DEF_CLOCK_SPEED</a>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#ad318eac443ef51629630fd01147003eb">DP_WARN</a>, PrintFlag,</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                       (<span class="stringliteral">&quot; *Warning: Event clock speed not specified, will default to %f MHz.\n&quot;</span>,</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        <a class="code" href="mrf_common_8h.html#af6962fd537fefce1778d02205c8562a5">MRF_DEF_CLOCK_SPEED</a>));</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        }<span class="comment">/*end if neither the control word nor the clock speed were specified*/</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;       <span class="comment">/*---------------------</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">        * Compute the control word for the desired clock speed.</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">        * Abort on error.</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        InputControlWord = <a class="code" href="group__mrf_common.html#gae361c0306ceb8ef7701c8bff663c56e3">FracSynthControlWord</a> (</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                               InputClockSpeed,</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                               ReferenceFreq,</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                               PrintFlag,</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                               &amp;Error);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">if</span> (0 == InputControlWord) {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#af46840b7d1e9fc3add9e7234d8ba5966">DP_FATAL</a>, <a class="code" href="debug_print_8h.html#af46840b7d1e9fc3add9e7234d8ba5966">DP_FATAL</a>,</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                   (<span class="stringliteral">&quot; *Error: Unable to compute fractional synthesizer control word for %f MHz.\n&quot;</span>,</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    InputClockSpeed));</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="mrf_frac_synth_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        }<span class="comment">/*end if could not compute fractional synthesizer control word*/</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    }<span class="comment">/*end if control word not specified*/</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">    * Analyze the control word for programming errors and get the actual frequency it will produce.</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">    * Abort if there are any serious problems.</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    ActualClockSpeed = <a class="code" href="group__mrf_common.html#ga42a0aecda942f6b758fbace9d8b3cdaa">FracSynthAnalyze</a> (InputControlWord, ReferenceFreq, PrintFlag);</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="keywordflow">if</span> (0.0 == ActualClockSpeed) {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#af46840b7d1e9fc3add9e7234d8ba5966">DP_FATAL</a>, <a class="code" href="debug_print_8h.html#af46840b7d1e9fc3add9e7234d8ba5966">DP_FATAL</a>,</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                (<span class="stringliteral">&quot; *Error: Fractional Synthesizer control word 0x%08x is invalid.\n&quot;</span>,</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                 InputControlWord));</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="mrf_frac_synth_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }<span class="comment">/*end if control word was invalid*/</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">    * If a clock speed was not specified, use the actual frequency generated by the control word.</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> (0.0 == InputClockSpeed)</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        InputClockSpeed = ActualClockSpeed;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">    * Check to make sure the difference between the requested and the actual frequencies</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">    * is within +/- 100 ppm.</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span> (0.0 == Error)</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        Error = 1.e6 * (ActualClockSpeed - InputClockSpeed) / InputClockSpeed;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">if</span> (fabs(Error) &gt;= 100.0) {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#af46840b7d1e9fc3add9e7234d8ba5966">DP_FATAL</a>, <a class="code" href="debug_print_8h.html#af46840b7d1e9fc3add9e7234d8ba5966">DP_FATAL</a>,</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                   (<span class="stringliteral">&quot; *Error: Requested frequency (%f) and actual frequency (%f) &quot;</span>,</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                    InputClockSpeed, ActualClockSpeed));</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <a class="code" href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a> (<a class="code" href="debug_print_8h.html#af46840b7d1e9fc3add9e7234d8ba5966">DP_FATAL</a>, <a class="code" href="debug_print_8h.html#af46840b7d1e9fc3add9e7234d8ba5966">DP_FATAL</a>,</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                   (<span class="stringliteral">&quot;differ by %6.2f ppm.\n         Difference must be less than +/- 100 ppm.\n&quot;</span>,</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                    Error));</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="mrf_frac_synth_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    }<span class="comment">/*end if error is too large*/</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;   <span class="comment">/*---------------------</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">    * If we made it this far, everything checked out OK.</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">    * Return the event clock speed and the fractional sythesizer control word.</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">    */</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    *OutputClockSpeed  = InputClockSpeed;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    *OutputControlWord = InputControlWord;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="mrf_frac_synth_8h.html#aba51915c87d64af47fb1cc59348961c9">OK</a>;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;}<span class="comment">/*end mrfSetEventClockSpeed()*/</span></div><div class="ttc" id="group__mrf_common_html_gae361c0306ceb8ef7701c8bff663c56e3"><div class="ttname"><a href="group__mrf_common.html#gae361c0306ceb8ef7701c8bff663c56e3">FracSynthControlWord</a></div><div class="ttdeci">epicsShareExtern epicsUInt32 FracSynthControlWord(epicsFloat64 DesiredFreq, epicsFloat64 ReferenceFreq, epicsInt32 debugFlag, epicsFloat64 *Error)</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00552">mrfFracSynth.c:552</a></div></div>
<div class="ttc" id="debug_print_8h_html_acb21e1590588b784857197e3e416673a"><div class="ttname"><a href="debug_print_8h.html#acb21e1590588b784857197e3e416673a">DEBUGPRINT</a></div><div class="ttdeci">#define DEBUGPRINT(interest, globalFlag, args)</div><div class="ttdef"><b>Definition:</b> <a href="debug_print_8h_source.html#l00102">debugPrint.h:102</a></div></div>
<div class="ttc" id="mrf_common_8h_html_af6962fd537fefce1778d02205c8562a5"><div class="ttname"><a href="mrf_common_8h.html#af6962fd537fefce1778d02205c8562a5">MRF_DEF_CLOCK_SPEED</a></div><div class="ttdeci">#define MRF_DEF_CLOCK_SPEED</div><div class="ttdef"><b>Definition:</b> <a href="mrf_common_8h_source.html#l00100">mrfCommon.h:100</a></div></div>
<div class="ttc" id="mrf_frac_synth_8h_html_aba51915c87d64af47fb1cc59348961c9"><div class="ttname"><a href="mrf_frac_synth_8h.html#aba51915c87d64af47fb1cc59348961c9">OK</a></div><div class="ttdeci">#define OK</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8h_source.html#l00081">mrfFracSynth.h:81</a></div></div>
<div class="ttc" id="mrf_frac_synth_8h_html_a8fe83ac76edc595f6b98cd4a4127aed5"><div class="ttname"><a href="mrf_frac_synth_8h.html#a8fe83ac76edc595f6b98cd4a4127aed5">ERROR</a></div><div class="ttdeci">#define ERROR</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8h_source.html#l00088">mrfFracSynth.h:88</a></div></div>
<div class="ttc" id="debug_print_8h_html_af46840b7d1e9fc3add9e7234d8ba5966"><div class="ttname"><a href="debug_print_8h.html#af46840b7d1e9fc3add9e7234d8ba5966">DP_FATAL</a></div><div class="ttdeci">#define DP_FATAL</div><div class="ttdef"><b>Definition:</b> <a href="debug_print_8h_source.html#l00089">debugPrint.h:89</a></div></div>
<div class="ttc" id="debug_print_8h_html_ad318eac443ef51629630fd01147003eb"><div class="ttname"><a href="debug_print_8h.html#ad318eac443ef51629630fd01147003eb">DP_WARN</a></div><div class="ttdeci">#define DP_WARN</div><div class="ttdef"><b>Definition:</b> <a href="debug_print_8h_source.html#l00091">debugPrint.h:91</a></div></div>
<div class="ttc" id="group__mrf_common_html_ga42a0aecda942f6b758fbace9d8b3cdaa"><div class="ttname"><a href="group__mrf_common.html#ga42a0aecda942f6b758fbace9d8b3cdaa">FracSynthAnalyze</a></div><div class="ttdeci">epicsShareExtern epicsFloat64 FracSynthAnalyze(epicsUInt32 ControlWord, epicsFloat64 ReferenceFreq, epicsInt32 PrintFlag)</div><div class="ttdef"><b>Definition:</b> <a href="mrf_frac_synth_8c_source.html#l00844">mrfFracSynth.c:844</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jan 24 2024 09:54:29 for mrfioc2 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
