# Record set for an EVR's physical output
#
# Macros:
#  ON = record name prefix
#  OBJ = devObj name
#  DESC = Physical label found on output jack


record(bo, "$(ON)Ena-SP") {
  field(DTYP, "Obj Prop bool")
  field(DESC, "Output $(DESC)")
  field(OUT , "@OBJ=$(OBJ), PROP=Enable")
  field(PINI, "YES")
  field(ZNAM, "Disabled")
  field(ONAM, "Enabled")
  field(VAL , "1") # Default to enabled
  info(autosaveFields_pass0, "VAL")
}

record(longout, "$(ON)Src-SP") {
  field(DTYP, "Obj Prop uint32")
  field(DESC, "$(DESC)")
  field(OUT , "@OBJ=$(OBJ), PROP=Map")
  field(FLNK, "$(ON)Src-RB_")
  field(PINI, "YES")
  field(VAL , "$(DEFAULT=63)") # default DEFAULT is Force Low
  info(autosaveFields_pass0, "VAL HOPR LOPR DRVH DRVL")
}

record(longout, "$(ON)Src2-SP") {
  field(DTYP, "Obj Prop uint32")
  field(DESC, "$(DESC)")
  field(OUT , "@OBJ=$(OBJ), PROP=Map2")
  field(FLNK, "$(ON)Src2-RB_")
  field(PINI, "YES")
  field(VAL , "$(DEFAULT=63)") # default DEFAULT is Force Low
  info(autosaveFields_pass0, "VAL HOPR LOPR DRVH DRVL")
}

# Settings
# Users use will set one of these at a time.

record(mbbo, "$(ON)Src$(s=:)Pulse-SP") {
  field(DTYP, "Raw Soft Channel")
  field(OUT , "$(ON)Src-SP PP")
  field(ZRST, "Pulser 0")
  field(ONST, "Pulser 1")
  field(TWST, "Pulser 2")
  field(THST, "Pulser 3")
  field(FRST, "Pulser 4")
  field(FVST, "Pulser 5")
  field(SXST, "Pulser 6")
  field(SVST, "Pulser 7")
  field(EIST, "Pulser 8")
  field(NIST, "Pulser 9")
  field(TEST, "Pulser 10")
  field(ELST, "Pulser 11")
  field(TVST, "Pulser 12")
  field(TTST, "Pulser 13")
  field(FTST, "Pulser 14")
  field(FFST, "Pulser 15")
  field(ZRVL, "0")
  field(ONVL, "1")
  field(TWVL, "2")
  field(THVL, "3")
  field(FRVL, "4")
  field(FVVL, "5")
  field(SXVL, "6")
  field(SVVL, "7")
  field(EIVL, "8")
  field(NIVL, "9")
  field(TEVL, "10")
  field(ELVL, "11")
  field(TVVL, "12")
  field(TTVL, "13")
  field(FTVL, "14")
  field(FFVL, "15")
  field(UNSV, "INVALID")
  field(IVOA, "Don't drive outputs")
  info(autosaveFields_pass0, "VAL")
}

record(mbbo, "$(ON)Src$(s=:)Pulse2-SP") {
  field(DTYP, "Raw Soft Channel")
  field(OUT , "$(ON)Src-SP PP")
  field(ZRST, "Pulser 16")
  field(ONST, "Pulser 17")
  field(TWST, "Pulser 18")
  field(THST, "Pulser 19")
  field(FRST, "Pulser 20")
  field(FVST, "Pulser 21")
  field(SXST, "Pulser 22")
  field(SVST, "Pulser 23")
  field(ZRVL, "16")
  field(ONVL, "17")
  field(TWVL, "18")
  field(THVL, "19")
  field(FRVL, "20")
  field(FVVL, "21")
  field(SXVL, "22")
  field(SVVL, "23")
  field(EISV, "INVALID")
  field(NISV, "INVALID")
  field(TESV, "INVALID")
  field(ELSV, "INVALID")
  field(TVSV, "INVALID")
  field(TTSV, "INVALID")
  field(FTSV, "INVALID")
  field(FFSV, "INVALID")
  field(UNSV, "INVALID")
  field(IVOA, "Don't drive outputs")
  info(autosaveFields_pass0, "VAL")
}

record(mbbo, "$(ON)Src2$(s=:)Pulse-SP") {
  field(DTYP, "Raw Soft Channel")
  field(OUT , "$(ON)Src2-SP PP")
  field(ZRST, "Pulser 0")
  field(ONST, "Pulser 1")
  field(TWST, "Pulser 2")
  field(THST, "Pulser 3")
  field(FRST, "Pulser 4")
  field(FVST, "Pulser 5")
  field(SXST, "Pulser 6")
  field(SVST, "Pulser 7")
  field(EIST, "Pulser 8")
  field(NIST, "Pulser 9")
  field(TEST, "Pulser 10")
  field(ELST, "Pulser 11")
  field(TVST, "Pulser 12")
  field(TTST, "Pulser 13")
  field(FTST, "Pulser 14")
  field(FFST, "Pulser 15")
  field(ZRVL, "0")
  field(ONVL, "1")
  field(TWVL, "2")
  field(THVL, "3")
  field(FRVL, "4")
  field(FVVL, "5")
  field(SXVL, "6")
  field(SVVL, "7")
  field(EIVL, "8")
  field(NIVL, "9")
  field(TEVL, "10")
  field(ELVL, "11")
  field(TVVL, "12")
  field(TTVL, "13")
  field(FTVL, "14")
  field(FFVL, "15")
  field(UNSV, "INVALID")
  field(IVOA, "Don't drive outputs")
  info(autosaveFields_pass0, "VAL")
}

record(mbbo, "$(ON)Src2$(s=:)Pulse2-SP") {
  field(DTYP, "Raw Soft Channel")
  field(OUT , "$(ON)Src2-SP PP")
  field(ZRST, "Pulser 16")
  field(ONST, "Pulser 17")
  field(TWST, "Pulser 18")
  field(THST, "Pulser 19")
  field(FRST, "Pulser 20")
  field(FVST, "Pulser 21")
  field(SXST, "Pulser 22")
  field(SVST, "Pulser 23")
  field(ZRVL, "16")
  field(ONVL, "17")
  field(TWVL, "18")
  field(THVL, "19")
  field(FRVL, "20")
  field(FVVL, "21")
  field(SXVL, "22")
  field(SVVL, "23")
  field(EISV, "INVALID")
  field(NISV, "INVALID")
  field(TESV, "INVALID")
  field(ELSV, "INVALID")
  field(TVSV, "INVALID")
  field(TTSV, "INVALID")
  field(FTSV, "INVALID")
  field(FFSV, "INVALID")
  field(UNSV, "INVALID")
  field(IVOA, "Don't drive outputs")
  info(autosaveFields_pass0, "VAL")
}

record(mbbo, "$(ON)Src$(s=:)DBus-SP") {
  field(DTYP, "Raw Soft Channel")
  field(OUT , "$(ON)Src-SP PP")
  field(ZRST, "DBus 0")
  field(ONST, "DBus 1")
  field(TWST, "DBus 2")
  field(THST, "DBus 3")
  field(FRST, "DBus 4")
  field(FVST, "DBus 5")
  field(SXST, "DBus 6")
  field(SVST, "DBus 7")
  field(ZRVL, "32")
  field(ONVL, "33")
  field(TWVL, "34")
  field(THVL, "35")
  field(FRVL, "36")
  field(FVVL, "37")
  field(SXVL, "38")
  field(SVVL, "39")
  field(EISV, "INVALID")
  field(NISV, "INVALID")
  field(TESV, "INVALID")
  field(ELSV, "INVALID")
  field(TVSV, "INVALID")
  field(TTSV, "INVALID")
  field(FTSV, "INVALID")
  field(FFSV, "INVALID")
  field(UNSV, "INVALID")
  field(IVOA, "Don't drive outputs")
  info(autosaveFields_pass0, "VAL")
}

record(mbbo, "$(ON)Src2$(s=:)DBus-SP") {
  field(DTYP, "Raw Soft Channel")
  field(OUT , "$(ON)Src2-SP PP")
  field(ZRST, "DBus 0")
  field(ONST, "DBus 1")
  field(TWST, "DBus 2")
  field(THST, "DBus 3")
  field(FRST, "DBus 4")
  field(FVST, "DBus 5")
  field(SXST, "DBus 6")
  field(SVST, "DBus 7")
  field(ZRVL, "32")
  field(ONVL, "33")
  field(TWVL, "34")
  field(THVL, "35")
  field(FRVL, "36")
  field(FVVL, "37")
  field(SXVL, "38")
  field(SVVL, "39")
  field(EISV, "INVALID")
  field(NISV, "INVALID")
  field(TESV, "INVALID")
  field(ELSV, "INVALID")
  field(TVSV, "INVALID")
  field(TTSV, "INVALID")
  field(FTSV, "INVALID")
  field(FFSV, "INVALID")
  field(UNSV, "INVALID")
  field(IVOA, "Don't drive outputs")
  info(autosaveFields_pass0, "VAL")
}

record(mbbo, "$(ON)Src$(s=:)Scale-SP") {
  field(DTYP, "Raw Soft Channel")
  field(OUT , "$(ON)Src-SP PP")
  field(ZRST, "Prescaler 0")
  field(ONST, "Prescaler 1")
  field(TWST, "Prescaler 2")
  field(THST, "Prescaler 3")
  field(FRST, "Prescaler 4")
  field(FVST, "Prescaler 5")
  field(SXST, "Prescaler 6")
  field(SVST, "Prescaler 7")
  field(ZRVL, "40")
  field(ONVL, "41")
  field(TWVL, "42")
  field(THVL, "43")
  field(FRVL, "44")
  field(FVVL, "45")
  field(SXVL, "46")
  field(SVVL, "47")
  field(EISV, "INVALID")
  field(NISV, "INVALID")
  field(TESV, "INVALID")
  field(ELSV, "INVALID")
  field(TVSV, "INVALID")
  field(TTSV, "INVALID")
  field(FTSV, "INVALID")
  field(FFSV, "INVALID")
  field(UNSV, "INVALID")
  field(IVOA, "Don't drive outputs")
  info(autosaveFields_pass0, "VAL")
}

record(mbbo, "$(ON)Src2$(s=:)Scale-SP") {
  field(DTYP, "Raw Soft Channel")
  field(OUT , "$(ON)Src2-SP PP")
  field(ZRST, "Prescaler 0")
  field(ONST, "Prescaler 1")
  field(TWST, "Prescaler 2")
  field(THST, "Prescaler 3")
  field(FRST, "Prescaler 4")
  field(FVST, "Prescaler 5")
  field(SXST, "Prescaler 6")
  field(SVST, "Prescaler 7")
  field(ZRVL, "40")
  field(ONVL, "41")
  field(TWVL, "42")
  field(THVL, "43")
  field(FRVL, "44")
  field(FVVL, "45")
  field(SXVL, "46")
  field(SVVL, "47")
  field(EISV, "INVALID")
  field(NISV, "INVALID")
  field(TESV, "INVALID")
  field(ELSV, "INVALID")
  field(TVSV, "INVALID")
  field(TTSV, "INVALID")
  field(FTSV, "INVALID")
  field(FFSV, "INVALID")
  field(UNSV, "INVALID")
  field(IVOA, "Don't drive outputs")
  info(autosaveFields_pass0, "VAL")
}

record(mbbo, "$(ON)Src$(s=:)Gate-SP") {
  field(DTYP, "Raw Soft Channel")
  field(OUT , "$(ON)Src-SP PP")
  field(ZRST, "Flip-flop 0")
  field(ONST, "Flip-flop 1")
  field(TWST, "Flip-flop 2")
  field(THST, "Flip-flop 3")
  field(FRST, "Flip-flop 4")
  field(FVST, "Flip-flop 5")
  field(SXST, "Flip-flop 6")
  field(SVST, "Flip-flop 7")
  field(EIST, "Tri-state")
  field(NIST, "Force High")
  field(TEST, "Force Low")
  field(ZRVL, "48")
  field(ONVL, "49")
  field(TWVL, "50")
  field(THVL, "51")
  field(FRVL, "52")
  field(FVVL, "53")
  field(SXVL, "54")
  field(SVVL, "55")
  field(EIVL, "61")
  field(NIVL, "62")
  field(TEVL, "63")
  field(ELSV, "INVALID")
  field(TVSV, "INVALID")
  field(TTSV, "INVALID")
  field(FTSV, "INVALID")
  field(FFSV, "INVALID")
  field(UNSV, "INVALID")
  field(IVOA, "Don't drive outputs")
  info(autosaveFields_pass0, "VAL")
}

record(mbbo, "$(ON)Src2$(s=:)Gate-SP") {
  field(DTYP, "Raw Soft Channel")
  field(OUT , "$(ON)Src2-SP PP")
  field(ZRST, "Flip-flop 0")
  field(ONST, "Flip-flop 1")
  field(TWST, "Flip-flop 2")
  field(THST, "Flip-flop 3")
  field(FRST, "Flip-flop 4")
  field(FVST, "Flip-flop 5")
  field(SXST, "Flip-flop 6")
  field(SVST, "Flip-flop 7")
  field(EIST, "Tri-state")
  field(NIST, "Force High")
  field(TEST, "Force Low")
  field(ZRVL, "48")
  field(ONVL, "49")
  field(TWVL, "50")
  field(THVL, "51")
  field(FRVL, "52")
  field(FVVL, "53")
  field(SXVL, "54")
  field(SVVL, "55")
  field(EIVL, "61")
  field(NIVL, "62")
  field(TEVL, "63")
  field(ELSV, "INVALID")
  field(TVSV, "INVALID")
  field(TTSV, "INVALID")
  field(FTSV, "INVALID")
  field(FFSV, "INVALID")
  field(UNSV, "INVALID")
  field(IVOA, "Don't drive outputs")
  info(autosaveFields_pass0, "VAL")
}

# Mapping readback

record(longin, "$(ON)Src-RB_") {
  field(ASG, "private")
  field(DTYP, "Obj Prop uint32")
  field(DESC, "$(DESC)")
  field(INP , "@OBJ=$(OBJ), PROP=Map")
  field(FLNK, "$(ON)Src-RB")
}

record(longin, "$(ON)Src2-RB_") {
  field(ASG, "private")
  field(DTYP, "Obj Prop uint32")
  field(DESC, "$(DESC)")
  field(INP , "@OBJ=$(OBJ), PROP=Map2")
  field(FLNK, "$(ON)Src2-RB")
}

record(stringin, "$(ON)Src-RB")
{
  field(DTYP, "LUT uint32 -> string")
  field(INP, "$(ON)Src-RB_")
  info(lut0 , " 0  = Pulser 0")
  info(lut1 , " 1  = Pulser 1")
  info(lut2 , " 2  = Pulser 2")
  info(lut3 , " 3  = Pulser 3")
  info(lut4 , " 4  = Pulser 4")
  info(lut5 , " 5  = Pulser 5")
  info(lut6 , " 6  = Pulser 6")
  info(lut7 , " 7  = Pulser 7")
  info(lut8 , " 8  = Pulser 8")
  info(lut9 , " 9  = Pulser 9")
  info(lutA , " 10 = Pulser 10")
  info(lutB , " 11 = Pulser 11")
  info(lutC , " 12 = Pulser 12")
  info(lutD , " 13 = Pulser 13")
  info(lutE , " 14 = Pulser 14")
  info(lutF , " 15 = Pulser 15")
  info(lutG , " 16 = Pulser 16")
  info(lutH , " 17 = Pulser 17")
  info(lutI , " 18 = Pulser 18")
  info(lutJ , " 19 = Pulser 19")
  info(lutK , " 20 = Pulser 20")
  info(lutL , " 21 = Pulser 21")
  info(lutM , " 22 = Pulser 22")
  info(lutN , " 23 = Pulser 23")
  info(lutO , " 32 = DBus 0")
  info(lutP , " 33 = DBus 1")
  info(lutQ , " 34 = DBus 2")
  info(lutR , " 35 = DBus 3")
  info(lutS , " 36 = DBus 4")
  info(lutT , " 37 = DBus 5")
  info(lutU , " 38 = DBus 6")
  info(lutV , " 39 = DBus 7")
  info(lutW , " 40 = Prescaler 0")
  info(lutX , " 41 = Prescaler 1")
  info(lutY , " 42 = Prescaler 2")
  info(lutZ , " 43 = Prescaler 3")
  info(lutAA, " 44 = Prescaler 4")
  info(lutAB, " 45 = Prescaler 5")
  info(lutAC, " 46 = Prescaler 6")
  info(lutAD, " 47 = Prescaler 7")
  info(lutAE, " 48 = Flip-flop 0")
  info(lutAF, " 49 = Flip-flop 1")
  info(lutAG, " 50 = Flip-flop 2")
  info(lutAH, " 51 = Flip-flop 3")
  info(lutAI, " 52 = Flip-flop 4")
  info(lutAJ, " 53 = Flip-flop 5")
  info(lutAK, " 54 = Flip-flop 6")
  info(lutAL, " 55 = Flip-flop 7")
  info(lutAM, " 61 = Tri-state")
  info(lutAN, " 62 = Force high")
  info(lutAO, " 63 = Force low")
}

record(stringin, "$(ON)Src2-RB")
{
  field(DTYP, "LUT uint32 -> string")
  field(INP, "$(ON)Src2-RB_")
  info(lut0 , " 0  = Pulser 0")
  info(lut1 , " 1  = Pulser 1")
  info(lut2 , " 2  = Pulser 2")
  info(lut3 , " 3  = Pulser 3")
  info(lut4 , " 4  = Pulser 4")
  info(lut5 , " 5  = Pulser 5")
  info(lut6 , " 6  = Pulser 6")
  info(lut7 , " 7  = Pulser 7")
  info(lut8 , " 8  = Pulser 8")
  info(lut9 , " 9  = Pulser 9")
  info(lutA , " 10 = Pulser 10")
  info(lutB , " 11 = Pulser 11")
  info(lutC , " 12 = Pulser 12")
  info(lutD , " 13 = Pulser 13")
  info(lutE , " 14 = Pulser 14")
  info(lutF , " 15 = Pulser 15")
  info(lutG , " 16 = Pulser 16")
  info(lutH , " 17 = Pulser 17")
  info(lutI , " 18 = Pulser 18")
  info(lutJ , " 19 = Pulser 19")
  info(lutK , " 20 = Pulser 20")
  info(lutL , " 21 = Pulser 21")
  info(lutM , " 22 = Pulser 22")
  info(lutN , " 23 = Pulser 23")
  info(lutO , " 32 = DBus 0")
  info(lutP , " 33 = DBus 1")
  info(lutQ , " 34 = DBus 2")
  info(lutR , " 35 = DBus 3")
  info(lutS , " 36 = DBus 4")
  info(lutT , " 37 = DBus 5")
  info(lutU , " 38 = DBus 6")
  info(lutV , " 39 = DBus 7")
  info(lutW , " 40 = Prescaler 0")
  info(lutX , " 41 = Prescaler 1")
  info(lutY , " 42 = Prescaler 2")
  info(lutZ , " 43 = Prescaler 3")
  info(lutAA, " 44 = Prescaler 4")
  info(lutAB, " 45 = Prescaler 5")
  info(lutAC, " 46 = Prescaler 6")
  info(lutAD, " 47 = Prescaler 7")
  info(lutAE, " 48 = Flip-flop 0")
  info(lutAF, " 49 = Flip-flop 1")
  info(lutAG, " 50 = Flip-flop 2")
  info(lutAH, " 51 = Flip-flop 3")
  info(lutAI, " 52 = Flip-flop 4")
  info(lutAJ, " 53 = Flip-flop 5")
  info(lutAK, " 54 = Flip-flop 6")
  info(lutAL, " 55 = Flip-flop 7")
  info(lutAM, " 61 = Tri-state")
  info(lutAN, " 62 = Force high")
  info(lutAO, " 63 = Force low")
}

# Select which is displayed

record(waveform, "$(ON)Label-I") {
  field(DESC, "Label")
  field(FTVL, "CHAR")
  field(NELM, "128")
  info(autosaveFields_pass1, "VAL")
  alias("$(ON)User-SP")
}
