# Record set for an EVR's physical output
#
# Macros:
#  P = record name prefix
#  O = Object suffix
#  OBJ = devObj name
#  DESC = Physical label found on output jack

record(longout, "$(P)$(O)src:set") {
  field( DTYP, "Obj Prop uint32")
  field( DESC, "$(DESC)")
  field( OUT , "@OBJ=$(OBJ), PROP=Map")
  field( FLNK, "$(P)$(O)src")
  field( PINI, "YES")
  field( VAL , "63")
  info(autosaveFields_pass0, "VAL HOPR LOPR DRVH DRVL")
}

# Settings
# Users use will set one of these at a time.

record(mbbo, "$(P)$(O)src:pulse:set") {
  field( DTYP, "Raw Soft Channel")
  field( OUT , "$(P)$(O)src:set PP")
  field( ZRST, "Pulser 0")
  field( ONST, "Pulser 1")
  field( TWST, "Pulser 2")
  field( THST, "Pulser 3")
  field( FRST, "Pulser 4")
  field( FVST, "Pulser 5")
  field( SXST, "Pulser 6")
  field( SVST, "Pulser 7")
  field( EIST, "Pulser 8")
  field( NIST, "Pulser 9")
  field( ZRVL, "0")
  field( ONVL, "1")
  field( TWVL, "2")
  field( THVL, "3")
  field( FRVL, "4")
  field( FVVL, "5")
  field( SXVL, "6")
  field( SVVL, "7")
  field( EIVL, "8")
  field( NIVL, "9")
  field( TESV, "INVALID")
  field( ELSV, "INVALID")
  field( TVSV, "INVALID")
  field( TTSV, "INVALID")
  field( FTSV, "INVALID")
  field( FFSV, "INVALID")
  field( UNSV, "INVALID")
  field( IVOA, "Don't drive outputs")
  info(autosaveFields_pass0, "VAL")
}

record(mbbo, "$(P)$(O)src:dbus:set") {
  field( DTYP, "Raw Soft Channel")
  field( OUT , "$(P)$(O)src:set PP")
  field( ZRST, "DBus 0")
  field( ONST, "DBus 1")
  field( TWST, "DBus 2")
  field( THST, "DBus 3")
  field( FRST, "DBus 4")
  field( FVST, "DBus 5")
  field( SXST, "DBus 6")
  field( SVST, "DBus 7")
  field( ZRVL, "32")
  field( ONVL, "33")
  field( TWVL, "34")
  field( THVL, "35")
  field( FRVL, "36")
  field( FVVL, "37")
  field( SXVL, "38")
  field( SVVL, "39")
  field( EISV, "INVALID")
  field( NISV, "INVALID")
  field( TESV, "INVALID")
  field( ELSV, "INVALID")
  field( TVSV, "INVALID")
  field( TTSV, "INVALID")
  field( FTSV, "INVALID")
  field( FFSV, "INVALID")
  field( UNSV, "INVALID")
  field( IVOA, "Don't drive outputs")
  info(autosaveFields_pass0, "VAL")
}

record(mbbo, "$(P)$(O)src:scale:set") {
  field( DTYP, "Raw Soft Channel")
  field( OUT , "$(P)$(O)src:set PP")
  field( ZRST, "Prescaler 0")
  field( ONST, "Prescaler 1")
  field( TWST, "Prescaler 2")
  field( ZRVL, "40")
  field( ONVL, "41")
  field( TWVL, "42")
  field( THST, "Force Low")
  field( FRST, "Force High")
  field( THVL, "63")
  field( FRVL, "62")
  field( VAL , "63")
  field( FVSV, "INVALID")
  field( SXSV, "INVALID")
  field( SVSV, "INVALID")
  field( EISV, "INVALID")
  field( NISV, "INVALID")
  field( TESV, "INVALID")
  field( ELSV, "INVALID")
  field( TVSV, "INVALID")
  field( TTSV, "INVALID")
  field( FTSV, "INVALID")
  field( FFSV, "INVALID")
  field( UNSV, "INVALID")
  field( IVOA, "Don't drive outputs")
  info(autosaveFields_pass0, "VAL")
}

# Mapping readback

record(longin, "$(P)$(O)src") {
  field( DTYP, "Obj Prop uint32")
  field( DESC, "$(DESC)")
  field( INP , "@OBJ=$(OBJ), PROP=Map")
  field( FLNK, "$(P)$(O)src:pulse")
}

record(mbbi, "$(P)$(O)src:pulse") {
  field( DTYP, "Raw Soft Channel")
  field( INP , "$(P)$(O)src")
  field( ZRST, "Pulser 0")
  field( ONST, "Pulser 1")
  field( TWST, "Pulser 2")
  field( THST, "Pulser 3")
  field( FRST, "Pulser 4")
  field( FVST, "Pulser 5")
  field( SXST, "Pulser 6")
  field( SVST, "Pulser 7")
  field( EIST, "Pulser 8")
  field( NIST, "Pulser 9")
  field( ZRVL, "0")
  field( ONVL, "1")
  field( TWVL, "2")
  field( THVL, "3")
  field( FRVL, "4")
  field( FVVL, "5")
  field( SXVL, "6")
  field( SVVL, "7")
  field( EIVL, "8")
  field( NIVL, "9")
  field( TESV, "MAJOR")
  field( ELSV, "MAJOR")
  field( TVSV, "MAJOR")
  field( TTSV, "MAJOR")
  field( FTSV, "MAJOR")
  field( FFSV, "MAJOR")
  field( UNSV, "MAJOR")
  field( FLNK, "$(P)$(O)src:dbus")
}

record(mbbi, "$(P)$(O)src:dbus") {
  field( DTYP, "Raw Soft Channel")
  field( INP , "$(P)$(O)src")
  field( ZRST, "DBus 0")
  field( ONST, "DBus 1")
  field( TWST, "DBus 2")
  field( THST, "DBus 3")
  field( FRST, "DBus 4")
  field( FVST, "DBus 5")
  field( SXST, "DBus 6")
  field( SVST, "DBus 7")
  field( ZRVL, "32")
  field( ONVL, "33")
  field( TWVL, "34")
  field( THVL, "35")
  field( FRVL, "36")
  field( FVVL, "37")
  field( SXVL, "38")
  field( SVVL, "39")
  field( EISV, "MAJOR")
  field( NISV, "MAJOR")
  field( TESV, "MAJOR")
  field( ELSV, "MAJOR")
  field( TVSV, "MAJOR")
  field( TTSV, "MAJOR")
  field( FTSV, "MAJOR")
  field( FFSV, "MAJOR")
  field( UNSV, "MAJOR")
  field( FLNK, "$(P)$(O)src:scale")
}

record(mbbi, "$(P)$(O)src:scale") {
  field( DTYP, "Raw Soft Channel")
  field( INP , "$(P)$(O)src")
  field( ZRST, "Prescaler 0")
  field( ONST, "Prescaler 1")
  field( TWST, "Prescaler 2")
  field( ZRVL, "40")
  field( ONVL, "41")
  field( TWVL, "42")
  field( THST, "Force Low")
  field( FRST, "Force High")
  field( THVL, "63")
  field( FRVL, "62")
  field( FVSV, "MAJOR")
  field( SXSV, "MAJOR")
  field( SVSV, "MAJOR")
  field( EISV, "MAJOR")
  field( NISV, "MAJOR")
  field( TESV, "MAJOR")
  field( ELSV, "MAJOR")
  field( TVSV, "MAJOR")
  field( TTSV, "MAJOR")
  field( FTSV, "MAJOR")
  field( FFSV, "MAJOR")
  field( UNSV, "MAJOR")
  field( UNSV, "MAJOR")
}

# Select which is displayed
